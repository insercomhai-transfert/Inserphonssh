{
  "version": "Notebook/1.0",
  "items": [
    {
      "type": 1,
      "content": {
        "json": "# HDInsight Spark Insights"
      },
      "name": "text - 0"
    },
    {
      "type": 9,
      "content": {
        "version": "KqlParameterItem/1.0",
        "crossComponentResources": [
          "{Cluster}"
        ],
        "parameters": [
          {
            "id": "804c95b2-ab8e-42c8-93e7-f14cb8701d7b",
            "version": "KqlParameterItem/1.0",
            "name": "Cluster",
            "type": 5,
            "isRequired": true,
            "typeSettings": {
              "additionalResourceOptions": [
                "value::1"
              ],
              "showDefault": false
            },
            "timeContext": {
              "durationMs": 86400000
            },
            "defaultValue": "value::1"
          },
          {
            "id": "509ede8c-c26f-44ab-a366-bc3147d208b2",
            "version": "KqlParameterItem/1.0",
            "name": "TimeRange",
            "type": 4,
            "isRequired": true,
            "value": {
              "durationMs": 300000
            },
            "typeSettings": {
              "selectableValues": [
                {
                  "durationMs": 300000
                },
                {
                  "durationMs": 900000
                },
                {
                  "durationMs": 1800000
                },
                {
                  "durationMs": 3600000
                },
                {
                  "durationMs": 14400000
                },
                {
                  "durationMs": 43200000
                },
                {
                  "durationMs": 86400000
                },
                {
                  "durationMs": 172800000
                },
                {
                  "durationMs": 259200000
                },
                {
                  "durationMs": 604800000
                },
                {
                  "durationMs": 1209600000
                },
                {
                  "durationMs": 2419200000
                },
                {
                  "durationMs": 2592000000
                },
                {
                  "durationMs": 5184000000
                },
                {
                  "durationMs": 7776000000
                }
              ],
              "allowCustom": true
            },
            "timeContext": {
              "durationMs": 86400000
            }
          },
          {
            "id": "0d2d78d0-c1d0-449e-ba60-1c83643828f3",
            "version": "KqlParameterItem/1.0",
            "name": "usage",
            "type": 1,
            "isRequired": true,
            "query": "let hasNonEmptyTable = (T:string, T2:string) \r\n{ \r\n   toscalar( \r\n   union isfuzzy=true \r\n   ( table(T) | take 1 | count as Count ),\r\n   ( table(T2) | take 1 | count as Count),\r\n   (print Count=0) \r\n   | summarize sum(Count) \r\n   ) > 1\r\n};\r\nlet TableName = 'HDInsightAmbariSystemMetrics';\r\nlet TableName2 = 'HDInsightAmbariClusterAlerts';\r\nprint  IsPresent=iif(hasNonEmptyTable(TableName,TableName2 ), \"present\", \"not present\")",
            "crossComponentResources": [
              "{Cluster}"
            ],
            "isHiddenWhenLocked": true,
            "queryType": 0,
            "resourceType": "microsoft.hdinsight/clusters"
          }
        ],
        "style": "pills",
        "queryType": 0,
        "resourceType": "microsoft.hdinsight/clusters"
      },
      "name": "Cluster Parameters"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 11,
            "content": {
              "version": "LinkItem/1.0",
              "style": "tabs",
              "links": [
                {
                  "id": "55d520e3-9b95-415a-9a50-160c634cb9ae",
                  "cellValue": "tab",
                  "linkTarget": "parameter",
                  "linkLabel": "Spark",
                  "subTarget": "Spark",
                  "style": "link"
                },
                {
                  "id": "bca0a33a-49f1-4c5b-a54d-55ac4524622d",
                  "cellValue": "tab",
                  "linkTarget": "parameter",
                  "linkLabel": "Hive",
                  "subTarget": "Hive",
                  "style": "link"
                },
                {
                  "id": "8b128f8b-5ddb-45a3-a5fb-31ea6f89f005",
                  "cellValue": "tab",
                  "linkTarget": "parameter",
                  "linkLabel": "YARN",
                  "subTarget": "Yarn",
                  "style": "link"
                },
                {
                  "id": "4265b2c9-3bad-4dd8-bade-c682d66d919b",
                  "cellValue": "tab",
                  "linkTarget": "parameter",
                  "linkLabel": "System Metrics",
                  "subTarget": "SystemMetrics",
                  "style": "link"
                },
                {
                  "id": "f7471a40-8188-45c0-9c21-3bb4ca24b891",
                  "cellValue": "tab",
                  "linkTarget": "parameter",
                  "linkLabel": "Component Logs",
                  "subTarget": "ComponentLogs",
                  "style": "link"
                }
              ]
            },
            "name": "links - 9"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "Component Logs",
              "items": [
                {
                  "type": 11,
                  "content": {
                    "version": "LinkItem/1.0",
                    "style": "tabs",
                    "links": [
                      {
                        "id": "fd7060b8-9b12-4fbb-9b23-ac2249ae9525",
                        "cellValue": "log_tab",
                        "linkTarget": "parameter",
                        "linkLabel": "Spark",
                        "subTarget": "Spark",
                        "style": "link"
                      },
                      {
                        "id": "7f177efd-978d-429d-a6ef-ecfae628a015",
                        "cellValue": "log_tab",
                        "linkTarget": "parameter",
                        "linkLabel": "Hadoop And Yarn",
                        "subTarget": "HadoopAndYarn",
                        "preText": "HadoopAndYarn",
                        "style": "link"
                      },
                      {
                        "id": "5aee8591-2b7b-4b46-8094-6a0a30c30c84",
                        "cellValue": "log_tab",
                        "linkTarget": "parameter",
                        "linkLabel": "Hive And LLAP",
                        "subTarget": "HiveAndLLAP",
                        "style": "link"
                      },
                      {
                        "id": "6a3088c1-2b51-4bf8-8e4e-700be683a0f0",
                        "cellValue": "log_tab",
                        "linkTarget": "parameter",
                        "linkLabel": "Oozie",
                        "subTarget": "Oozie",
                        "style": "link"
                      }
                    ]
                  },
                  "name": "links - 5"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "crossComponentResources": [
                            "{Cluster}"
                          ],
                          "parameters": [
                            {
                              "id": "d209cf7b-ddb7-4ec2-9e8b-e5772d397d5d",
                              "version": "KqlParameterItem/1.0",
                              "name": "HadoopAndYarnLogType",
                              "label": "LogType",
                              "type": 2,
                              "description": "Log Types that will show in the table",
                              "isRequired": true,
                              "multiSelect": true,
                              "quote": "'",
                              "delimiter": ",",
                              "query": "HDInsightHadoopAndYarnLogs\r\n| where TimeGenerated {TimeRange}\r\n| distinct LogType",
                              "crossComponentResources": [
                                "{Cluster}"
                              ],
                              "typeSettings": {
                                "additionalResourceOptions": [
                                  "value::1",
                                  "value::all"
                                ],
                                "showDefault": false
                              },
                              "timeContext": {
                                "durationMs": 5184000000
                              },
                              "timeContextFromParameter": "TimeRange",
                              "defaultValue": "value::1",
                              "queryType": 0,
                              "resourceType": "microsoft.hdinsight/clusters"
                            },
                            {
                              "id": "e3973cc7-67a7-46e3-b0e5-b6b5dd0b392e",
                              "version": "KqlParameterItem/1.0",
                              "name": "HadoopAndYarnLogLevel",
                              "label": "LogLevel",
                              "type": 2,
                              "description": "Log Level of Logs returned in queries",
                              "isRequired": true,
                              "multiSelect": true,
                              "quote": "'",
                              "delimiter": ",",
                              "query": "HDInsightHadoopAndYarnLogs\r\n| where TimeGenerated {TimeRange}\r\n| distinct LogLevel",
                              "crossComponentResources": [
                                "{Cluster}"
                              ],
                              "typeSettings": {
                                "additionalResourceOptions": [
                                  "value::1",
                                  "value::all"
                                ],
                                "showDefault": false
                              },
                              "timeContext": {
                                "durationMs": 0
                              },
                              "timeContextFromParameter": "TimeRange",
                              "defaultValue": "value::1",
                              "queryType": 0,
                              "resourceType": "microsoft.hdinsight/clusters"
                            },
                            {
                              "id": "686bc2e9-cceb-45c6-86b5-de58babe71f5",
                              "version": "KqlParameterItem/1.0",
                              "name": "HadoopAndYarnNumberofLogs",
                              "type": 1,
                              "description": "Number of Logs that will be returned in query",
                              "isRequired": true,
                              "value": "20",
                              "timeContext": {
                                "durationMs": 0
                              },
                              "timeContextFromParameter": "TimeRange",
                              "label": "NumberofLogs"
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.hdinsight/clusters"
                        },
                        "name": "parameters - 6"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "HDInsightHadoopAndYarnLogs\r\n| where LogType in ({HadoopAndYarnLogType}) and LogLevel in ({HadoopAndYarnLogLevel})\r\n| take {HadoopAndYarnNumberofLogs}\r\n| project TimeGenerated, LogType, LogLevel ,Message\r\n|order by TimeGenerated desc",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Hadoop and Yarn Logs",
                          "timeContext": {
                            "durationMs": 0
                          },
                          "timeContextFromParameter": "TimeRange",
                          "queryType": 0,
                          "resourceType": "microsoft.hdinsight/clusters",
                          "crossComponentResources": [
                            "{Cluster}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "Message",
                                "formatter": 0,
                                "formatOptions": {
                                  "customColumnWidthSetting": "230.1429ch"
                                }
                              }
                            ]
                          }
                        },
                        "name": "Hadoop and Yarn Logs"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "HDInsightHadoopAndYarnLogs\r\n| where LogType in ({HadoopAndYarnLogType}) and LogLevel in ({HadoopAndYarnLogLevel})\r\n| summarize count() by LogLevel, bin(TimeGenerated, {TimeRange:grain})\r\n|order by TimeGenerated desc\r\n| take 10000",
                          "size": 0,
                          "aggregation": 5,
                          "showAnalytics": true,
                          "title": "Log Level Counts",
                          "timeContext": {
                            "durationMs": 0
                          },
                          "timeContextFromParameter": "TimeRange",
                          "queryType": 0,
                          "resourceType": "microsoft.hdinsight/clusters",
                          "crossComponentResources": [
                            "{Cluster}"
                          ],
                          "visualization": "linechart",
                          "chartSettings": {
                            "seriesLabelSettings": [
                              {
                                "seriesName": "INFO",
                                "label": "Info",
                                "color": "green"
                              },
                              {
                                "seriesName": "WARN",
                                "label": "Warning",
                                "color": "yellow"
                              },
                              {
                                "seriesName": "ERROR",
                                "label": "Error",
                                "color": "redBright"
                              }
                            ]
                          }
                        },
                        "name": "Log Level Counts"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "log_tab",
                    "comparison": "isEqualTo",
                    "value": "HadoopAndYarn"
                  },
                  "name": "Hadoop And Yarn Logs"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "crossComponentResources": [
                            "{Cluster}"
                          ],
                          "parameters": [
                            {
                              "id": "d209cf7b-ddb7-4ec2-9e8b-e5772d397d5d",
                              "version": "KqlParameterItem/1.0",
                              "name": "HiveLogType",
                              "label": "LogType",
                              "type": 2,
                              "description": "Log Types that will show in the table",
                              "isRequired": true,
                              "multiSelect": true,
                              "quote": "'",
                              "delimiter": ",",
                              "query": "HDInsightHiveAndLLAPLogs\r\n| where TimeGenerated {TimeRange}\r\n| distinct LogType",
                              "crossComponentResources": [
                                "{Cluster}"
                              ],
                              "typeSettings": {
                                "additionalResourceOptions": [
                                  "value::1",
                                  "value::all"
                                ],
                                "showDefault": false
                              },
                              "timeContext": {
                                "durationMs": 0
                              },
                              "timeContextFromParameter": "TimeRange",
                              "defaultValue": "value::1",
                              "queryType": 0,
                              "resourceType": "microsoft.hdinsight/clusters"
                            },
                            {
                              "id": "e3973cc7-67a7-46e3-b0e5-b6b5dd0b392e",
                              "version": "KqlParameterItem/1.0",
                              "name": "HiveLogLevel",
                              "label": "LogLevel",
                              "type": 2,
                              "description": "Log Level of Logs returned in queries",
                              "isRequired": true,
                              "multiSelect": true,
                              "quote": "'",
                              "delimiter": ",",
                              "query": "HDInsightHiveAndLLAPLogs\r\n| where TimeGenerated {TimeRange}\r\n| distinct LogLevel",
                              "crossComponentResources": [
                                "{Cluster}"
                              ],
                              "typeSettings": {
                                "additionalResourceOptions": [
                                  "value::1",
                                  "value::all"
                                ],
                                "showDefault": false
                              },
                              "timeContext": {
                                "durationMs": 0
                              },
                              "timeContextFromParameter": "TimeRange",
                              "defaultValue": "value::all",
                              "queryType": 0,
                              "resourceType": "microsoft.hdinsight/clusters"
                            },
                            {
                              "id": "686bc2e9-cceb-45c6-86b5-de58babe71f5",
                              "version": "KqlParameterItem/1.0",
                              "name": "HiveNumberofLogs",
                              "type": 1,
                              "description": "Number of Logs that will be returned in query",
                              "isRequired": true,
                              "value": "20",
                              "timeContext": {
                                "durationMs": 0
                              },
                              "timeContextFromParameter": "TimeRange",
                              "label": "NumberofLogs"
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.hdinsight/clusters"
                        },
                        "name": "parameters - 6 - Copy"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "HDInsightHiveAndLLAPLogs\r\n| where ClusterName == '{Cluster:label}'\r\n| where LogType in ({HiveLogType}) and LogLevel in ({HiveLogLevel})\r\n| take {HiveNumberofLogs}\r\n| project TimeGenerated, LogType, LogLevel ,Message\r\n|order by TimeGenerated desc",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Hive and LLAP Logs",
                          "timeContext": {
                            "durationMs": 0
                          },
                          "timeContextFromParameter": "TimeRange",
                          "queryType": 0,
                          "resourceType": "microsoft.hdinsight/clusters",
                          "crossComponentResources": [
                            "{Cluster}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "Message",
                                "formatter": 0,
                                "formatOptions": {
                                  "customColumnWidthSetting": "230.1429ch"
                                }
                              }
                            ]
                          }
                        },
                        "name": "Hive and LLAP Logs"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "HDInsightHiveAndLLAPLogs\r\n| where LogType in ({HiveLogType}) and LogLevel in ({HiveLogLevel})\r\n| summarize count() by LogLevel, bin(TimeGenerated, {TimeRange:grain})\r\n|order by TimeGenerated desc\r\n| take 10000",
                          "size": 0,
                          "aggregation": 5,
                          "showAnalytics": true,
                          "title": "Log Level Counts",
                          "timeContext": {
                            "durationMs": 0
                          },
                          "timeContextFromParameter": "TimeRange",
                          "queryType": 0,
                          "resourceType": "microsoft.hdinsight/clusters",
                          "crossComponentResources": [
                            "{Cluster}"
                          ],
                          "visualization": "linechart"
                        },
                        "name": "Log Level Counts - Copy"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "log_tab",
                    "comparison": "isEqualTo",
                    "value": "HiveAndLLAP"
                  },
                  "name": "Hive Logs"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "Oozie Logs",
                    "items": [
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "crossComponentResources": [
                            "{Cluster}"
                          ],
                          "parameters": [
                            {
                              "id": "d209cf7b-ddb7-4ec2-9e8b-e5772d397d5d",
                              "version": "KqlParameterItem/1.0",
                              "name": "OozieLogType",
                              "label": "LogType",
                              "type": 2,
                              "description": "Log Types that will show in the table",
                              "isRequired": true,
                              "multiSelect": true,
                              "quote": "'",
                              "delimiter": ",",
                              "query": "HDInsightOozieLogs\r\n| where TimeGenerated {TimeRange}\r\n| distinct LogType",
                              "crossComponentResources": [
                                "{Cluster}"
                              ],
                              "typeSettings": {
                                "additionalResourceOptions": [
                                  "value::1",
                                  "value::all"
                                ],
                                "showDefault": false
                              },
                              "timeContext": {
                                "durationMs": 5184000000
                              },
                              "timeContextFromParameter": "TimeRange",
                              "defaultValue": "value::1",
                              "queryType": 0,
                              "resourceType": "microsoft.hdinsight/clusters"
                            },
                            {
                              "id": "e3973cc7-67a7-46e3-b0e5-b6b5dd0b392e",
                              "version": "KqlParameterItem/1.0",
                              "name": "OozieLogLevel",
                              "label": "LogLevel",
                              "type": 2,
                              "description": "Log Level of Logs returned in queries",
                              "isRequired": true,
                              "multiSelect": true,
                              "quote": "'",
                              "delimiter": ",",
                              "query": "HDInsightOozieLogs\r\n| where TimeGenerated {TimeRange}\r\n| distinct LogLevel",
                              "crossComponentResources": [
                                "{Cluster}"
                              ],
                              "typeSettings": {
                                "additionalResourceOptions": [
                                  "value::all"
                                ],
                                "showDefault": false
                              },
                              "timeContext": {
                                "durationMs": 0
                              },
                              "timeContextFromParameter": "TimeRange",
                              "defaultValue": "value::all",
                              "queryType": 0,
                              "resourceType": "microsoft.hdinsight/clusters"
                            },
                            {
                              "id": "686bc2e9-cceb-45c6-86b5-de58babe71f5",
                              "version": "KqlParameterItem/1.0",
                              "name": "OozieNumberofLogs",
                              "label": "NumberofLogs",
                              "type": 1,
                              "description": "Number of Logs that will be returned in query",
                              "isRequired": true,
                              "value": "20",
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "timeContextFromParameter": "TimeRange"
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.hdinsight/clusters"
                        },
                        "name": "parameters - 6 - Copy"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "HDInsightOozieLogs\r\n| where LogType in ({OozieLogType}) and LogLevel in ({OozieLogLevel})\r\n| take {OozieNumberofLogs}\r\n| project TimeGenerated, LogType, LogLevel ,Message\r\n|order by TimeGenerated desc",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Oozie Logs",
                          "timeContext": {
                            "durationMs": 0
                          },
                          "timeContextFromParameter": "TimeRange",
                          "queryType": 0,
                          "resourceType": "microsoft.hdinsight/clusters",
                          "crossComponentResources": [
                            "{Cluster}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "Message",
                                "formatter": 0,
                                "formatOptions": {
                                  "customColumnWidthSetting": "230.1429ch"
                                }
                              }
                            ]
                          }
                        },
                        "name": "Hive and LLAP Logs"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "HDInsightOozieLogs\r\n| where LogType in ({OozieLogType}) and LogLevel in ({OozieLogLevel})\r\n| summarize count() by LogLevel, bin(TimeGenerated, {TimeRange:grain})\r\n|order by TimeGenerated desc\r\n| take 10000",
                          "size": 0,
                          "aggregation": 5,
                          "showAnalytics": true,
                          "title": "Log Level Counts",
                          "timeContext": {
                            "durationMs": 0
                          },
                          "timeContextFromParameter": "TimeRange",
                          "queryType": 0,
                          "resourceType": "microsoft.hdinsight/clusters",
                          "crossComponentResources": [
                            "{Cluster}"
                          ],
                          "visualization": "linechart",
                          "chartSettings": {
                            "seriesLabelSettings": [
                              {
                                "seriesName": "INFO",
                                "label": "Info",
                                "color": "green"
                              },
                              {
                                "seriesName": "WARN",
                                "label": "Warning",
                                "color": "yellow"
                              },
                              {
                                "seriesName": "Error",
                                "label": "Error",
                                "color": "redBright"
                              }
                            ]
                          }
                        },
                        "name": "Log Level Counts - Copy"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "log_tab",
                    "comparison": "isEqualTo",
                    "value": "Oozie"
                  },
                  "name": "Oozie Logs"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "Spark Logs",
                    "items": [
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "crossComponentResources": [
                            "{Cluster}"
                          ],
                          "parameters": [
                            {
                              "id": "d209cf7b-ddb7-4ec2-9e8b-e5772d397d5d",
                              "version": "KqlParameterItem/1.0",
                              "name": "SparkLogType",
                              "label": "LogType",
                              "type": 2,
                              "description": "Log Types that will show in the table",
                              "isRequired": true,
                              "multiSelect": true,
                              "quote": "'",
                              "delimiter": ",",
                              "query": "HDInsightSparkLogs\r\n| where TimeGenerated {TimeRange}\r\n| distinct LogType",
                              "crossComponentResources": [
                                "{Cluster}"
                              ],
                              "value": [
                                "value::all"
                              ],
                              "typeSettings": {
                                "additionalResourceOptions": [
                                  "value::1",
                                  "value::all"
                                ],
                                "showDefault": false
                              },
                              "timeContext": {
                                "durationMs": 0
                              },
                              "timeContextFromParameter": "TimeRange",
                              "defaultValue": "value::all",
                              "queryType": 0,
                              "resourceType": "microsoft.hdinsight/clusters"
                            },
                            {
                              "id": "e3973cc7-67a7-46e3-b0e5-b6b5dd0b392e",
                              "version": "KqlParameterItem/1.0",
                              "name": "SparkLogLevel",
                              "label": "LogLevel",
                              "type": 2,
                              "description": "Log Level of Logs returned in queries",
                              "isRequired": true,
                              "multiSelect": true,
                              "quote": "'",
                              "delimiter": ",",
                              "query": "HDInsightSparkLogs\r\n| where TimeGenerated {TimeRange}\r\n| distinct LogLevel",
                              "crossComponentResources": [
                                "{Cluster}"
                              ],
                              "typeSettings": {
                                "additionalResourceOptions": [
                                  "value::1",
                                  "value::all"
                                ],
                                "showDefault": false
                              },
                              "timeContext": {
                                "durationMs": 0
                              },
                              "timeContextFromParameter": "TimeRange",
                              "defaultValue": "value::all",
                              "queryType": 0,
                              "resourceType": "microsoft.hdinsight/clusters"
                            },
                            {
                              "id": "686bc2e9-cceb-45c6-86b5-de58babe71f5",
                              "version": "KqlParameterItem/1.0",
                              "name": "SparkNumberofLogs",
                              "label": "NumberofLogs",
                              "type": 1,
                              "description": "Number of Logs that will be returned in query",
                              "isRequired": true,
                              "value": "20",
                              "timeContext": {
                                "durationMs": 43200000
                              },
                              "timeContextFromParameter": "TimeRange"
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.hdinsight/clusters"
                        },
                        "name": "parameters - 6 - Copy"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "HDInsightSparkLogs\r\n| where ClusterName == '{Cluster:label}'\r\n| where LogType in ({SparkLogType}) and LogLevel in ({SparkLogLevel})\r\n| take {SparkNumberofLogs}\r\n| project TimeGenerated, LogType, LogLevel ,Message\r\n|order by TimeGenerated desc",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Spark Logs",
                          "timeContext": {
                            "durationMs": 300000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "queryType": 0,
                          "resourceType": "microsoft.hdinsight/clusters",
                          "crossComponentResources": [
                            "{Cluster}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "Message",
                                "formatter": 0,
                                "formatOptions": {
                                  "customColumnWidthSetting": "230.1429ch"
                                }
                              }
                            ]
                          }
                        },
                        "name": "Spark Logs"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "HDInsightSparkLogs\r\n| where LogType in ({SparkLogType}) and LogLevel in ({SparkLogLevel})\r\n| summarize count() by LogLevel, bin(TimeGenerated, {TimeRange:grain})\r\n|order by TimeGenerated desc\r\n| take 10000",
                          "size": 0,
                          "aggregation": 5,
                          "showAnalytics": true,
                          "title": "Log Level Counts",
                          "timeContext": {
                            "durationMs": 300000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "queryType": 0,
                          "resourceType": "microsoft.hdinsight/clusters",
                          "crossComponentResources": [
                            "{Cluster}"
                          ],
                          "visualization": "linechart",
                          "chartSettings": {
                            "seriesLabelSettings": [
                              {
                                "seriesName": "INFO",
                                "label": "Info",
                                "color": "green"
                              },
                              {
                                "seriesName": "ERROR",
                                "label": "Error",
                                "color": "redBright"
                              },
                              {
                                "seriesName": "WARN",
                                "label": "Warning",
                                "color": "yellow"
                              }
                            ]
                          }
                        },
                        "name": "Log Level Counts - Copy"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "log_tab",
                    "comparison": "isEqualTo",
                    "value": "Spark"
                  },
                  "name": "Spark Logs"
                }
              ]
            },
            "conditionalVisibilities": [
              {
                "parameterName": "Cluster",
                "comparison": "isNotEqualTo"
              },
              {
                "parameterName": "tab",
                "comparison": "isEqualTo",
                "value": "ComponentLogs"
              }
            ],
            "name": "Component Logs"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "System Metrics",
              "items": [
                {
                  "type": 11,
                  "content": {
                    "version": "LinkItem/1.0",
                    "style": "tabs",
                    "links": [
                      {
                        "id": "623b56d9-85b7-4708-b6f5-096f91d8a697",
                        "cellValue": "metrics_tab",
                        "linkTarget": "parameter",
                        "linkLabel": "Disk",
                        "subTarget": "Disk",
                        "preText": "Disk",
                        "style": "link"
                      },
                      {
                        "id": "7906c8da-965b-4910-9823-44f4e17d40fa",
                        "cellValue": "metrics_tab",
                        "linkTarget": "parameter",
                        "linkLabel": "CPU",
                        "subTarget": "CPU",
                        "style": "link"
                      },
                      {
                        "id": "9cf5e622-416e-4714-8f04-55e13dded4b4",
                        "cellValue": "metrics_tab",
                        "linkTarget": "parameter",
                        "linkLabel": "Memory",
                        "subTarget": "Memory",
                        "style": "link"
                      },
                      {
                        "id": "8e2525b1-e020-4f04-a2fc-d9154b2d3640",
                        "cellValue": "metrics_tab",
                        "linkTarget": "parameter",
                        "linkLabel": "Load",
                        "subTarget": "Load",
                        "style": "link"
                      }
                    ]
                  },
                  "name": "links - 4"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "Disk",
                    "items": [
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "HDInsightAmbariSystemMetrics\r\n| extend NodeType = substring(HostName,0,2)\r\n| summarize DiskPercentUsed = (1 - sum(DiskFree)/sum(DiskTotal))*100 by NodeType, bin(TimeGenerated, {TimeRange:grain})\r\n|order by TimeGenerated desc\r\n| take 10000",
                          "size": 0,
                          "aggregation": 5,
                          "showAnalytics": true,
                          "title": "Disk Usage Percentage by Node Type",
                          "timeContext": {
                            "durationMs": 300000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "queryType": 0,
                          "resourceType": "microsoft.hdinsight/clusters",
                          "crossComponentResources": [
                            "{Cluster}"
                          ],
                          "visualization": "linechart",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "DiskPercentFree",
                                "formatter": 0,
                                "numberFormat": {
                                  "unit": 0,
                                  "options": {
                                    "style": "percent",
                                    "useGrouping": false
                                  }
                                }
                              }
                            ]
                          },
                          "chartSettings": {
                            "ySettings": {
                              "numberFormatSettings": {
                                "unit": 1,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": true,
                                  "maximumSignificantDigits": 3
                                }
                              }
                            }
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 0"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "HDInsightAmbariSystemMetrics\r\n| summarize  DiskPercentUsed = (1 - sum(DiskFree)/sum(DiskTotal))*100, DiskUsedGB=avg(DiskTotal - DiskFree) by HostName, bin(TimeGenerated, {TimeRange:grain})\r\n| order by TimeGenerated, HostName desc\r\n| summarize arg_max(TimeGenerated, *) by HostName\r\n| sort by DiskPercentUsed desc\r\n",
                          "size": 0,
                          "aggregation": 5,
                          "showAnalytics": true,
                          "title": "Disk Used Percentage by Host",
                          "timeContext": {
                            "durationMs": 300000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "queryType": 0,
                          "resourceType": "microsoft.hdinsight/clusters",
                          "crossComponentResources": [
                            "{Cluster}"
                          ],
                          "visualization": "table",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "DiskPercentUsed",
                                "formatter": 8,
                                "formatOptions": {
                                  "min": 0,
                                  "max": 100,
                                  "palette": "greenRed"
                                },
                                "numberFormat": {
                                  "unit": 1,
                                  "options": {
                                    "style": "decimal",
                                    "useGrouping": false,
                                    "maximumSignificantDigits": 3
                                  }
                                }
                              },
                              {
                                "columnMatch": "DiskUsedGB",
                                "formatter": 0,
                                "numberFormat": {
                                  "unit": 0,
                                  "options": {
                                    "style": "decimal",
                                    "useGrouping": false,
                                    "maximumFractionDigits": 2
                                  }
                                }
                              }
                            ],
                            "sortBy": [
                              {
                                "itemKey": "$gen_heatmap_DiskPercentUsed_2",
                                "sortOrder": 2
                              }
                            ]
                          },
                          "sortBy": [
                            {
                              "itemKey": "$gen_heatmap_DiskPercentUsed_2",
                              "sortOrder": 2
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "Disk Usage Per Host"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "HDInsightAmbariSystemMetrics\r\n| where ClusterName == '{Cluster:label}'\r\n| where TimeGenerated {TimeRange}\r\n| make-series avg(ReadCount) default=double(null) on TimeGenerated in range({TimeRange:start} , {TimeRange:end}, {TimeRange:grain}) by HostName\r\n| extend filled_avg_metric_value = series_fill_forward(avg_ReadCount) \r\n| mv-expand TimeGenerated to typeof(datetime), filled_avg_metric_value to typeof(int)\r\n| order by HostName desc,TimeGenerated asc \r\n| extend RateOfChange = iif(prev(HostName) == HostName, (filled_avg_metric_value - prev(filled_avg_metric_value, 1))/60.0, 0.0)\r\n| project TimeGenerated, HostName, RateOfChange",
                          "size": 0,
                          "aggregation": 5,
                          "showAnalytics": true,
                          "title": "Disk Read Count Per Second by Host",
                          "timeContext": {
                            "durationMs": 300000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "queryType": 0,
                          "resourceType": "microsoft.hdinsight/clusters",
                          "crossComponentResources": [
                            "{Cluster}"
                          ],
                          "visualization": "linechart"
                        },
                        "customWidth": "50",
                        "showPin": true,
                        "name": "Disk Read Count Per Second"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "HDInsightAmbariSystemMetrics\r\n| where TimeGenerated {TimeRange}\r\n| make-series avg(WriteCount) default=double(null) on TimeGenerated in range({TimeRange:start} , {TimeRange:end}, {TimeRange:grain}) by HostName\r\n| extend filled_avg_metric_value = series_fill_forward(avg_WriteCount) \r\n| mv-expand TimeGenerated to typeof(datetime), filled_avg_metric_value to typeof(int)\r\n| order by HostName desc,TimeGenerated asc \r\n| extend RateOfChange = iif(prev(HostName) == HostName, (filled_avg_metric_value - prev(filled_avg_metric_value, 1))/60.0, 0.0)\r\n| project TimeGenerated, HostName, RateOfChange",
                          "size": 0,
                          "aggregation": 5,
                          "showAnalytics": true,
                          "title": "Disk Write Count Per Second by Host",
                          "timeContext": {
                            "durationMs": 300000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "queryType": 0,
                          "resourceType": "microsoft.hdinsight/clusters",
                          "crossComponentResources": [
                            "{Cluster}"
                          ],
                          "visualization": "linechart"
                        },
                        "customWidth": "50",
                        "showPin": true,
                        "name": "Disk Write Count Per Second by Host"
                      }
                    ]
                  },
                  "conditionalVisibilities": [
                    {
                      "parameterName": "Cluster",
                      "comparison": "isNotEqualTo"
                    },
                    {
                      "parameterName": "metrics_tab",
                      "comparison": "isEqualTo",
                      "value": "Disk"
                    }
                  ],
                  "name": "Disk"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "CPU Metrics",
                    "items": [
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "HDInsightAmbariSystemMetrics\r\n| extend NodeType = substring(HostName,0,2)\r\n| summarize CPUUsagePercentage = avg(100 - CpuIdle) by NodeType, bin(TimeGenerated, {TimeRange:grain})\r\n",
                          "size": 0,
                          "aggregation": 5,
                          "showAnalytics": true,
                          "title": "CPU Usage Percentage by Node Type",
                          "timeContext": {
                            "durationMs": 0
                          },
                          "timeContextFromParameter": "TimeRange",
                          "queryType": 0,
                          "resourceType": "microsoft.hdinsight/clusters",
                          "crossComponentResources": [
                            "{Cluster}"
                          ],
                          "visualization": "linechart",
                          "chartSettings": {
                            "ySettings": {
                              "numberFormatSettings": {
                                "unit": 1,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": true,
                                  "maximumSignificantDigits": 3
                                }
                              }
                            }
                          }
                        },
                        "customWidth": "50",
                        "name": "CPU Usage Percentage by Node Type"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "HDInsightAmbariSystemMetrics\r\n| summarize CPUUsagePercentage = avg(100 - CpuIdle) by HostName, bin(TimeGenerated, {TimeRange:grain})\r\n|order by TimeGenerated desc\r\n| summarize arg_max(TimeGenerated, *) by HostName\r\n| sort by CPUUsagePercentage desc",
                          "size": 0,
                          "aggregation": 5,
                          "showAnalytics": true,
                          "title": "CPU Usage Percentage by Host",
                          "timeContext": {
                            "durationMs": 0
                          },
                          "timeContextFromParameter": "TimeRange",
                          "queryType": 0,
                          "resourceType": "microsoft.hdinsight/clusters",
                          "crossComponentResources": [
                            "{Cluster}"
                          ],
                          "visualization": "table",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "CPUUsagePercentage",
                                "formatter": 8,
                                "formatOptions": {
                                  "min": 0,
                                  "max": 100,
                                  "palette": "greenRed"
                                },
                                "numberFormat": {
                                  "unit": 1,
                                  "options": {
                                    "style": "decimal",
                                    "useGrouping": false,
                                    "maximumSignificantDigits": 3
                                  }
                                }
                              }
                            ],
                            "sortBy": [
                              {
                                "itemKey": "$gen_heatmap_CPUUsagePercentage_2",
                                "sortOrder": 2
                              }
                            ]
                          },
                          "sortBy": [
                            {
                              "itemKey": "$gen_heatmap_CPUUsagePercentage_2",
                              "sortOrder": 2
                            }
                          ]
                        },
                        "customWidth": "50",
                        "showPin": true,
                        "name": "CPU Usage Percentage by Host"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "metrics_tab",
                    "comparison": "isEqualTo",
                    "value": "CPU"
                  },
                  "name": "CPU"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "Memory Metrics",
                    "items": [
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "HDInsightAmbariSystemMetrics\r\n| extend NodeType = substring(HostName,0,2)\r\n| summarize FreeMemory = avg(FreeMemory) by NodeType, bin(TimeGenerated, {TimeRange:grain})\r\n",
                          "size": 0,
                          "aggregation": 5,
                          "showAnalytics": true,
                          "title": "Free Memory in Bytes by Node Type",
                          "timeContext": {
                            "durationMs": 0
                          },
                          "timeContextFromParameter": "TimeRange",
                          "queryType": 0,
                          "resourceType": "microsoft.hdinsight/clusters",
                          "crossComponentResources": [
                            "{Cluster}"
                          ],
                          "visualization": "linechart",
                          "chartSettings": {
                            "ySettings": {
                              "numberFormatSettings": {
                                "unit": 2,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": true
                                }
                              }
                            }
                          }
                        },
                        "customWidth": "50",
                        "showPin": true,
                        "name": "Free Memory in Bytes by Node Type"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "HDInsightAmbariSystemMetrics\r\n| summarize MemoryUsedPercentage = (1 - sum(FreeMemory)/sum(TotalMemory))*100 by  HostName, bin(TimeGenerated, {TimeRange:grain})\r\n|order by TimeGenerated desc\r\n| summarize arg_max(TimeGenerated, *) by HostName\r\n| sort by MemoryUsedPercentage desc",
                          "size": 0,
                          "aggregation": 5,
                          "showAnalytics": true,
                          "title": "Memory Usage Percentage by Host",
                          "timeContext": {
                            "durationMs": 0
                          },
                          "timeContextFromParameter": "TimeRange",
                          "queryType": 0,
                          "resourceType": "microsoft.hdinsight/clusters",
                          "crossComponentResources": [
                            "{Cluster}"
                          ],
                          "visualization": "table",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "MemoryUsedPercentage",
                                "formatter": 8,
                                "formatOptions": {
                                  "min": 0,
                                  "max": 100,
                                  "palette": "greenRed"
                                },
                                "numberFormat": {
                                  "unit": 1,
                                  "options": {
                                    "style": "decimal",
                                    "useGrouping": false,
                                    "maximumSignificantDigits": 3
                                  }
                                }
                              }
                            ]
                          }
                        },
                        "customWidth": "50",
                        "showPin": true,
                        "name": "Memory Usage Percentage by Host"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "metrics_tab",
                    "comparison": "isEqualTo",
                    "value": "Memory"
                  },
                  "name": "Memory"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "Load Metrics",
                    "items": [
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "HDInsightAmbariSystemMetrics\r\n| extend NodeType = substring(HostName,0,2)\r\n| summarize OneMinuteLoad = avg(OneMinuteLoad) by NodeType, bin(TimeGenerated, {TimeRange:grain})",
                          "size": 0,
                          "aggregation": 5,
                          "showAnalytics": true,
                          "title": "One Minute Load by Node Type",
                          "timeContext": {
                            "durationMs": 0
                          },
                          "timeContextFromParameter": "TimeRange",
                          "queryType": 0,
                          "resourceType": "microsoft.hdinsight/clusters",
                          "crossComponentResources": [
                            "{Cluster}"
                          ],
                          "visualization": "linechart"
                        },
                        "customWidth": "50",
                        "name": "query - 0"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "HDInsightAmbariSystemMetrics\r\n| where ClusterName == '{Cluster:label}'\r\n| summarize OneMinuteLoad = avg(OneMinuteLoad) by HostName, bin(TimeGenerated, {TimeRange:grain})\r\n|order by TimeGenerated desc\r\n| summarize arg_max(TimeGenerated, *) by HostName\r\n| sort by OneMinuteLoad desc",
                          "size": 0,
                          "aggregation": 5,
                          "showAnalytics": true,
                          "title": "One Minute Load by Node",
                          "timeContext": {
                            "durationMs": 0
                          },
                          "timeContextFromParameter": "TimeRange",
                          "queryType": 0,
                          "resourceType": "microsoft.hdinsight/clusters",
                          "crossComponentResources": [
                            "{Cluster}"
                          ],
                          "visualization": "table",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "OneMinuteLoad",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "red"
                                }
                              }
                            ]
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 0 - Copy"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "HDInsightAmbariSystemMetrics\r\n| where ClusterName == '{Cluster:label}'\r\n| extend NodeType = substring(HostName,0,2)\r\n| summarize FiveMinuteLoad = avg(FiveMinuteLoad) by NodeType, bin(TimeGenerated, {TimeRange:grain})",
                          "size": 0,
                          "aggregation": 5,
                          "showAnalytics": true,
                          "title": "Five Minute Load by Node Type",
                          "timeContext": {
                            "durationMs": 0
                          },
                          "timeContextFromParameter": "TimeRange",
                          "queryType": 0,
                          "resourceType": "microsoft.hdinsight/clusters",
                          "crossComponentResources": [
                            "{Cluster}"
                          ],
                          "visualization": "linechart"
                        },
                        "customWidth": "50",
                        "name": "query - 0 - Copy"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "HDInsightAmbariSystemMetrics\r\n| summarize FiveMinuteLoad = avg(FiveMinuteLoad) by HostName, bin(TimeGenerated, {TimeRange:grain})\r\n|order by TimeGenerated desc\r\n| summarize arg_max(TimeGenerated, *) by HostName\r\n| sort by FiveMinuteLoad desc",
                          "size": 0,
                          "aggregation": 5,
                          "showAnalytics": true,
                          "title": "Five Minute Load by Node",
                          "timeContext": {
                            "durationMs": 0
                          },
                          "timeContextFromParameter": "TimeRange",
                          "queryType": 0,
                          "resourceType": "microsoft.hdinsight/clusters",
                          "crossComponentResources": [
                            "{Cluster}"
                          ],
                          "visualization": "table",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "FiveMinuteLoad",
                                "formatter": 8,
                                "formatOptions": {
                                  "palette": "red"
                                }
                              }
                            ]
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 0 - Copy - Copy"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "metrics_tab",
                    "comparison": "isEqualTo",
                    "value": "Load"
                  },
                  "name": "Load"
                }
              ]
            },
            "conditionalVisibilities": [
              {
                "parameterName": "Cluster",
                "comparison": "isNotEqualTo"
              },
              {
                "parameterName": "tab",
                "comparison": "isEqualTo",
                "value": "SystemMetrics"
              }
            ],
            "name": "System Metrics"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 11,
                  "content": {
                    "version": "LinkItem/1.0",
                    "style": "tabs",
                    "links": [
                      {
                        "id": "a04ba5c0-6c78-4a99-a7ca-78ddbd3f57c0",
                        "cellValue": "yarn_tab",
                        "linkTarget": "parameter",
                        "linkLabel": "Overview",
                        "subTarget": "Overview",
                        "style": "link"
                      },
                      {
                        "id": "ccae0674-d61e-46ee-904d-14a6b58dc883",
                        "cellValue": "yarn_tab",
                        "linkTarget": "parameter",
                        "linkLabel": "Apps",
                        "subTarget": "Apps",
                        "preText": "",
                        "style": "link"
                      },
                      {
                        "id": "3a013ca8-11d2-4ca8-af6d-b15b80d7a042",
                        "cellValue": "yarn_tab",
                        "linkTarget": "parameter",
                        "linkLabel": "Node Managers",
                        "subTarget": "NodeManagers",
                        "style": "link"
                      },
                      {
                        "id": "e47483ee-fb27-459d-abcb-ace7081a7c66",
                        "cellValue": "yarn_tab",
                        "linkTarget": "parameter",
                        "linkLabel": "JVM",
                        "subTarget": "JVM",
                        "style": "link"
                      },
                      {
                        "id": "e9e32c59-5d4c-4eed-8dd0-bc8b0dcc3d91",
                        "cellValue": "yarn_tab",
                        "linkTarget": "parameter",
                        "linkLabel": "Timeline Server",
                        "subTarget": "TimelineServer",
                        "style": "link"
                      }
                    ]
                  },
                  "name": "links - 0"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "Yarn App Metrics",
                    "items": [
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "HDInsightHadoopAndYarnMetrics\r\n| where ClusterName == '{Cluster:label}'\r\n| where MetricName contains \"Apps\" \r\n| summarize arg_max(TimeGenerated,*) by MetricNamespace, MetricName\r\n| summarize sum(MetricValue) by MetricName, bin(TimeGenerated,{TimeRange:grain})",
                          "size": 0,
                          "aggregation": 5,
                          "title": "App States",
                          "timeContext": {
                            "durationMs": 0
                          },
                          "timeContextFromParameter": "TimeRange",
                          "queryType": 0,
                          "resourceType": "microsoft.hdinsight/clusters",
                          "crossComponentResources": [
                            "{Cluster}"
                          ],
                          "visualization": "linechart"
                        },
                        "name": "App States"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "HDInsightHadoopAndYarnMetrics\r\n| where ClusterName == '{Cluster:label}'\r\n| where MetricName == \"AMLaunchDelayAvgTime\"\r\n| summarize arg_max(TimeGenerated,*) by MetricNamespace, MetricName\r\n| summarize avg(MetricValue) by MetricName, bin(TimeGenerated,{TimeRange:grain})",
                          "size": 0,
                          "aggregation": 5,
                          "showAnalytics": true,
                          "title": "Avg AM Launch Delay Time in MS",
                          "timeContext": {
                            "durationMs": 0
                          },
                          "timeContextFromParameter": "TimeRange",
                          "queryType": 0,
                          "resourceType": "microsoft.hdinsight/clusters",
                          "crossComponentResources": [
                            "{Cluster}"
                          ],
                          "visualization": "linechart",
                          "chartSettings": {
                            "ySettings": {
                              "numberFormatSettings": {
                                "unit": 23,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": true
                                }
                              }
                            }
                          }
                        },
                        "customWidth": "50",
                        "name": "Avg AM Launch Delay Time in MS"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "HDInsightHadoopAndYarnMetrics\r\n| where ClusterName == '{Cluster:label}'\r\n| where MetricName == \"AMRegisterDelayAvgTime\"\r\n| summarize arg_max(TimeGenerated,*) by MetricNamespace, MetricName\r\n| summarize sum(MetricValue) by MetricName, bin(TimeGenerated,{TimeRange:grain})",
                          "size": 0,
                          "aggregation": 5,
                          "showAnalytics": true,
                          "title": "Avg AM Register Delay Time in MS",
                          "timeContext": {
                            "durationMs": 0
                          },
                          "timeContextFromParameter": "TimeRange",
                          "queryType": 0,
                          "resourceType": "microsoft.hdinsight/clusters",
                          "crossComponentResources": [
                            "{Cluster}"
                          ],
                          "visualization": "linechart",
                          "chartSettings": {
                            "ySettings": {
                              "numberFormatSettings": {
                                "unit": 23,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": true
                                }
                              }
                            }
                          }
                        },
                        "customWidth": "50",
                        "name": "Avg AM Register Delay Time in MS"
                      }
                    ]
                  },
                  "conditionalVisibilities": [
                    {
                      "parameterName": "Cluster",
                      "comparison": "isNotEqualTo"
                    },
                    {
                      "parameterName": "yarn_tab",
                      "comparison": "isEqualTo",
                      "value": "Apps"
                    }
                  ],
                  "name": "Apps"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "Node Manager",
                    "items": [
                      {
                        "type": 11,
                        "content": {
                          "version": "LinkItem/1.0",
                          "style": "tabs",
                          "links": [
                            {
                              "id": "c78d5501-b3ce-4f09-aa35-97a49527cf77",
                              "cellValue": "nm_tab",
                              "linkTarget": "parameter",
                              "linkLabel": "Containers",
                              "subTarget": "Containers",
                              "style": "link"
                            },
                            {
                              "id": "f2078e19-2d79-4ab5-857c-ebc8c8495a53",
                              "cellValue": "nm_tab",
                              "linkTarget": "parameter",
                              "linkLabel": "Memory",
                              "subTarget": "Memory",
                              "style": "link"
                            },
                            {
                              "id": "01bcba1f-b799-4819-a3ff-4b8556c63795",
                              "cellValue": "nm_tab",
                              "linkTarget": "parameter",
                              "linkLabel": "Disk",
                              "subTarget": "Disk",
                              "style": "link"
                            }
                          ]
                        },
                        "name": "links - 1"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "title": "Node Manager Containers",
                          "items": [
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "HDInsightHadoopAndYarnMetrics\r\n| where ClusterName == '{Cluster:label}'\r\n| where MetricNamespace contains \"NodeManager\" and (MetricName == \"ContainersRunning\" or MetricName == \"ContainersCompleted\" or MetricName == \"ContainersKilled\" or MetricName == \"ContainersFailed\")\r\n| summarize max(MetricValue) by MetricName, bin(TimeGenerated,{TimeRange:grain})",
                                "size": 0,
                                "aggregation": 5,
                                "title": "Container States",
                                "timeContext": {
                                  "durationMs": 0
                                },
                                "timeContextFromParameter": "TimeRange",
                                "queryType": 0,
                                "resourceType": "microsoft.hdinsight/clusters",
                                "crossComponentResources": [
                                  "{Cluster}"
                                ],
                                "visualization": "linechart"
                              },
                              "name": "Container States"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "HDInsightHadoopAndYarnMetrics\r\n| where ClusterName == '{Cluster:label}'\r\n| where MetricName == \"ContainerLaunchDurationAvgTime\"\r\n| take 10000\r\n| project ClusterName, TimeGenerated, MetricValue",
                                "size": 0,
                                "aggregation": 5,
                                "showAnalytics": true,
                                "title": "Average Container Launch Delay in MS",
                                "timeContext": {
                                  "durationMs": 0
                                },
                                "timeContextFromParameter": "TimeRange",
                                "queryType": 0,
                                "resourceType": "microsoft.hdinsight/clusters",
                                "crossComponentResources": [
                                  "{Cluster}"
                                ],
                                "visualization": "linechart",
                                "chartSettings": {
                                  "xSettings": {
                                    "numberFormatSettings": {
                                      "unit": 0,
                                      "options": {
                                        "style": "decimal",
                                        "useGrouping": true
                                      }
                                    }
                                  },
                                  "ySettings": {
                                    "numberFormatSettings": {
                                      "unit": 23,
                                      "options": {
                                        "style": "decimal",
                                        "useGrouping": true
                                      }
                                    }
                                  }
                                }
                              },
                              "name": "query - 2"
                            }
                          ]
                        },
                        "conditionalVisibility": {
                          "parameterName": "nm_tab",
                          "comparison": "isEqualTo",
                          "value": "Containers"
                        },
                        "name": "Containers"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "title": "Node Manager Memory",
                          "items": [
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "HDInsightHadoopAndYarnMetrics\r\n| where ClusterName == '{Cluster:label}'\r\n| where MetricNamespace contains \"NodeManager\" and MetricName == \"AvailableGB\"\r\n| take 10000\r\n| project ClusterName, TimeGenerated, MetricValue",
                                "size": 0,
                                "aggregation": 5,
                                "showAnalytics": true,
                                "title": "Memory Available",
                                "timeContext": {
                                  "durationMs": 0
                                },
                                "timeContextFromParameter": "TimeRange",
                                "queryType": 0,
                                "resourceType": "microsoft.hdinsight/clusters",
                                "crossComponentResources": [
                                  "{Cluster}"
                                ],
                                "visualization": "linechart",
                                "chartSettings": {
                                  "ySettings": {
                                    "numberFormatSettings": {
                                      "unit": 5,
                                      "options": {
                                        "style": "decimal",
                                        "useGrouping": true
                                      }
                                    }
                                  }
                                }
                              },
                              "customWidth": "50",
                              "name": "query - 0"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "HDInsightHadoopAndYarnMetrics\r\n| where MetricNamespace contains \"NodeManager\" and MetricName == \"AllocatedGB\"\r\n| take 10000\r\n| project ClusterName, TimeGenerated, MetricValue",
                                "size": 0,
                                "aggregation": 5,
                                "showAnalytics": true,
                                "title": "Memory Allocated",
                                "timeContext": {
                                  "durationMs": 0
                                },
                                "timeContextFromParameter": "TimeRange",
                                "queryType": 0,
                                "resourceType": "microsoft.hdinsight/clusters",
                                "crossComponentResources": [
                                  "{Cluster}"
                                ],
                                "visualization": "linechart",
                                "chartSettings": {
                                  "ySettings": {
                                    "numberFormatSettings": {
                                      "unit": 5,
                                      "options": {
                                        "style": "decimal",
                                        "useGrouping": true
                                      }
                                    }
                                  }
                                }
                              },
                              "customWidth": "50",
                              "name": "query - 0 - Copy"
                            }
                          ]
                        },
                        "conditionalVisibility": {
                          "parameterName": "nm_tab",
                          "comparison": "isEqualTo",
                          "value": "Memory"
                        },
                        "name": "Node Manager Memory"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "title": "Node Manager Disk",
                          "items": [
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "HDInsightHadoopAndYarnMetrics\r\n| where MetricNamespace contains \"NodeManager\" and MetricName == \"GoodLogDirsDiskUtilizationPerc\"\r\n| take 10000\r\n| project ClusterName, TimeGenerated, MetricValue",
                                "size": 0,
                                "aggregation": 5,
                                "showAnalytics": true,
                                "title": "Disk Utilization for Good Log Dirs",
                                "timeContext": {
                                  "durationMs": 0
                                },
                                "timeContextFromParameter": "TimeRange",
                                "queryType": 0,
                                "resourceType": "microsoft.hdinsight/clusters",
                                "crossComponentResources": [
                                  "{Cluster}"
                                ],
                                "visualization": "linechart",
                                "chartSettings": {
                                  "ySettings": {
                                    "numberFormatSettings": {
                                      "unit": 1,
                                      "options": {
                                        "style": "decimal",
                                        "useGrouping": true,
                                        "maximumSignificantDigits": 3
                                      }
                                    }
                                  }
                                }
                              },
                              "customWidth": "50",
                              "name": "query - 0"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "HDInsightHadoopAndYarnMetrics\r\n| where ClusterName == '{Cluster:label}'\r\n| where MetricNamespace contains \"NodeManager\" and MetricName == \"GoodLocalDirsDiskUtilizationPerc\"\r\n| take 10000\r\n| project ClusterName, TimeGenerated, MetricValue",
                                "size": 0,
                                "aggregation": 5,
                                "showAnalytics": true,
                                "title": "Disk Utilization for Good Local Dirs",
                                "timeContext": {
                                  "durationMs": 0
                                },
                                "timeContextFromParameter": "TimeRange",
                                "queryType": 0,
                                "resourceType": "microsoft.hdinsight/clusters",
                                "crossComponentResources": [
                                  "{Cluster}"
                                ],
                                "visualization": "linechart",
                                "chartSettings": {
                                  "ySettings": {
                                    "numberFormatSettings": {
                                      "unit": 1,
                                      "options": {
                                        "style": "decimal",
                                        "useGrouping": true,
                                        "maximumSignificantDigits": 3
                                      }
                                    }
                                  }
                                }
                              },
                              "customWidth": "50",
                              "name": "query - 0 - Copy"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "HDInsightHadoopAndYarnMetrics\r\n| where ClusterName == '{Cluster:label}'\r\n| where MetricNamespace contains \"NodeManager\" and MetricName == \"BadLogDirs\"\r\n| take 10000\r\n| project ClusterName, TimeGenerated, MetricValue",
                                "size": 0,
                                "aggregation": 5,
                                "showAnalytics": true,
                                "title": "Num Bad Log Dirs",
                                "timeContext": {
                                  "durationMs": 0
                                },
                                "timeContextFromParameter": "TimeRange",
                                "queryType": 0,
                                "resourceType": "microsoft.hdinsight/clusters",
                                "crossComponentResources": [
                                  "{Cluster}"
                                ],
                                "visualization": "linechart"
                              },
                              "customWidth": "50",
                              "name": "query - 0 - Copy - Copy"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "HDInsightHadoopAndYarnMetrics\r\n| where MetricNamespace contains \"NodeManager\" and MetricName == \"BadLocalDirs\"\r\n| take 10000\r\n| project ClusterName, TimeGenerated, MetricValue",
                                "size": 0,
                                "aggregation": 5,
                                "showAnalytics": true,
                                "title": "Num Bad Local Dirs",
                                "timeContext": {
                                  "durationMs": 0
                                },
                                "timeContextFromParameter": "TimeRange",
                                "queryType": 0,
                                "resourceType": "microsoft.hdinsight/clusters",
                                "crossComponentResources": [
                                  "{Cluster}"
                                ],
                                "visualization": "linechart"
                              },
                              "customWidth": "50",
                              "name": "query - 0 - Copy - Copy - Copy"
                            }
                          ]
                        },
                        "conditionalVisibility": {
                          "parameterName": "nm_tab",
                          "comparison": "isEqualTo",
                          "value": "Disk"
                        },
                        "name": "Node Manager Disk"
                      }
                    ]
                  },
                  "conditionalVisibilities": [
                    {
                      "parameterName": "Cluster",
                      "comparison": "isNotEqualTo"
                    },
                    {
                      "parameterName": "yarn_tab",
                      "comparison": "isEqualTo",
                      "value": "NodeManagers"
                    }
                  ],
                  "name": "Node Manager"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "YARN Cluster Overview",
                    "items": [
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "HDInsightHadoopAndYarnMetrics\r\n| where MetricName == \"NumActiveNMs\"\r\n| order by TimeGenerated desc\r\n| take 1\r\n",
                          "size": 4,
                          "showAnalytics": true,
                          "title": "Active Nodes",
                          "timeContext": {
                            "durationMs": 300000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "queryType": 0,
                          "resourceType": "microsoft.hdinsight/clusters",
                          "crossComponentResources": [
                            "{Cluster}"
                          ],
                          "visualization": "tiles",
                          "tileSettings": {
                            "titleContent": {
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "MetricValue",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            },
                            "showBorder": false
                          }
                        },
                        "customWidth": "25",
                        "name": "query - 0",
                        "styleSettings": {
                          "showBorder": true
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "HDInsightHadoopAndYarnMetrics\r\n| where MetricName == \"AvailableMB\"\r\n| order by TimeGenerated desc\r\n| take 1\r\n",
                          "size": 4,
                          "showAnalytics": true,
                          "title": "Cluster Memory Available",
                          "timeContext": {
                            "durationMs": 300000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "queryType": 0,
                          "resourceType": "microsoft.hdinsight/clusters",
                          "crossComponentResources": [
                            "{Cluster}"
                          ],
                          "visualization": "tiles",
                          "tileSettings": {
                            "titleContent": {
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "MetricValue",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 4,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": false,
                                  "maximumFractionDigits": 2,
                                  "maximumSignificantDigits": 3
                                }
                              }
                            },
                            "showBorder": false
                          }
                        },
                        "customWidth": "25",
                        "name": "Cluster Memory Available",
                        "styleSettings": {
                          "showBorder": true
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "HDInsightHadoopAndYarnMetrics\r\n| where ClusterName == '{Cluster:label}'\r\n| where MetricName == \"AppsRunning\"\r\n| order by TimeGenerated desc\r\n| take 1\r\n",
                          "size": 4,
                          "showAnalytics": true,
                          "title": "Running Apps",
                          "timeContext": {
                            "durationMs": 300000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "queryType": 0,
                          "resourceType": "microsoft.hdinsight/clusters",
                          "crossComponentResources": [
                            "{Cluster}"
                          ],
                          "visualization": "tiles",
                          "tileSettings": {
                            "titleContent": {
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "MetricValue",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 0,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": false,
                                  "maximumFractionDigits": 2,
                                  "maximumSignificantDigits": 3
                                }
                              }
                            },
                            "showBorder": false
                          }
                        },
                        "customWidth": "25",
                        "name": "Running Apps",
                        "styleSettings": {
                          "showBorder": true
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "HDInsightHadoopAndYarnMetrics\r\n| where MetricName == \"MemHeapUsedM\"\r\n| order by TimeGenerated desc\r\n| take 1\r\n",
                          "size": 4,
                          "showAnalytics": true,
                          "title": "Resource Manager Heap Usage",
                          "timeContext": {
                            "durationMs": 300000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "queryType": 0,
                          "resourceType": "microsoft.hdinsight/clusters",
                          "crossComponentResources": [
                            "{Cluster}"
                          ],
                          "visualization": "tiles",
                          "tileSettings": {
                            "titleContent": {
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "MetricValue",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 4,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": false,
                                  "maximumFractionDigits": 2,
                                  "maximumSignificantDigits": 3
                                }
                              }
                            },
                            "showBorder": false
                          }
                        },
                        "customWidth": "25",
                        "name": "Resource Manager Heap",
                        "styleSettings": {
                          "showBorder": true
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "HDInsightHadoopAndYarnMetrics\r\n| where ClusterName == '{Cluster:label}'\r\n| where MetricName == \"NumActiveNMs\" or MetricName == \"NumUnhealthyNMs\" or MetricName == \"NumLostNMs\" or MetricName == \"NumDecommisionedNMs\" or MetricName == \"NumRebootedNMs\" \r\n| summarize avg(MetricValue) by MetricName, bin(TimeGenerated,{TimeRange:grain})",
                          "size": 0,
                          "aggregation": 5,
                          "showAnalytics": true,
                          "title": "Node States",
                          "timeContext": {
                            "durationMs": 300000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "queryType": 0,
                          "resourceType": "microsoft.hdinsight/clusters",
                          "crossComponentResources": [
                            "{Cluster}"
                          ],
                          "visualization": "linechart"
                        },
                        "customWidth": "50",
                        "name": "query - 4"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "HDInsightHadoopAndYarnMetrics\r\n| where ClusterName == '{Cluster:label}'\r\n| where MetricName == \"AppsRunning\" or MetricName == \"AppsPending\" or MetricName == \"AppsFailed\" or MetricName == \"AppsComplete\" or MetricName == \"AppsSubmitted\" \r\n| summarize arg_max(TimeGenerated,*) by MetricNamespace, MetricName\r\n| summarize sum(MetricValue) by MetricName, bin(TimeGenerated,{TimeRange:grain})",
                          "size": 0,
                          "aggregation": 5,
                          "showAnalytics": true,
                          "title": "App States",
                          "timeContext": {
                            "durationMs": 300000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "queryType": 0,
                          "resourceType": "microsoft.hdinsight/clusters",
                          "crossComponentResources": [
                            "{Cluster}"
                          ],
                          "visualization": "linechart"
                        },
                        "customWidth": "50",
                        "name": "query - 4 - Copy"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "HDInsightHadoopAndYarnMetrics\r\n| where MetricName == \"AvailableMB\"// and MetricNamespace == \"Hadoop:service=ResourceManager,name=QueueMetrics,q0=root\"\r\n| summarize MetricValue=max(MetricValue) by MetricNamespace, bin(TimeGenerated, {TimeRange:grain})\r\n| extend MetricNamespace = substring(MetricNamespace, 36)\r\n| order by TimeGenerated desc\r\n| take 10000\r\n| project MetricNamespace, TimeGenerated, MetricValue\r\n",
                          "size": 0,
                          "aggregation": 5,
                          "showAnalytics": true,
                          "title": "Cluster Memory Available",
                          "timeContext": {
                            "durationMs": 300000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "queryType": 0,
                          "resourceType": "microsoft.hdinsight/clusters",
                          "crossComponentResources": [
                            "{Cluster}"
                          ],
                          "visualization": "linechart",
                          "tileSettings": {
                            "titleContent": {
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "MetricValue",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 4,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": false,
                                  "maximumFractionDigits": 2,
                                  "maximumSignificantDigits": 3
                                }
                              }
                            },
                            "showBorder": false
                          },
                          "chartSettings": {
                            "ySettings": {
                              "numberFormatSettings": {
                                "unit": 4,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": true
                                }
                              }
                            }
                          }
                        },
                        "name": "Cluster Memory Available - Copy",
                        "styleSettings": {
                          "showBorder": true
                        }
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "yarn_tab",
                    "comparison": "isEqualTo",
                    "value": "Overview"
                  },
                  "name": "Overview"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "YARN JVM",
                    "items": [
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "aa7b52fb-0130-4b7f-a34a-a212b473d176",
                              "version": "KqlParameterItem/1.0",
                              "name": "Component",
                              "type": 2,
                              "description": "Component to get JVM metrics for",
                              "isRequired": true,
                              "value": "NodeManager",
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    { \"value\":\"NodeManager\", \"label\":\"NodeManager\" },\r\n    { \"value\":\"ResourceManager\", \"label\":\"ResourceManager\" },\r\n    { \"value\":\"ApplicationHistoryServer\", \"label\":\"TimelineServer\"},\r\n    { \"value\":\"JobHistoryServer\", \"label\":\"JobHistoryServer\"}\r\n]",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "name": "parameters - 1"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "HDInsightHadoopAndYarnMetrics\r\n| where MetricNamespace contains '{Component}' and MetricName == \"MemHeapUsedM\" \r\n| summarize avg(MetricValue) by HostName,bin(TimeGenerated, {TimeRange:grain})\r\n|order by TimeGenerated desc\r\n| take 10000\r\n",
                          "size": 0,
                          "aggregation": 5,
                          "showAnalytics": true,
                          "title": "JVM Heap Usage in MB",
                          "timeContext": {
                            "durationMs": 0
                          },
                          "timeContextFromParameter": "TimeRange",
                          "queryType": 0,
                          "resourceType": "microsoft.hdinsight/clusters",
                          "crossComponentResources": [
                            "{Cluster}"
                          ],
                          "visualization": "linechart",
                          "chartSettings": {
                            "ySettings": {
                              "numberFormatSettings": {
                                "unit": 4,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": true
                                }
                              }
                            }
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 0"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "HDInsightHadoopAndYarnMetrics\r\n| where MetricNamespace contains '{Component}' and MetricName == \"MemNonHeapUsedM\" \r\n| summarize avg(MetricValue) by HostName,bin(TimeGenerated, {TimeRange:grain})\r\n|order by TimeGenerated desc\r\n| take 10000\r\n",
                          "size": 0,
                          "aggregation": 5,
                          "showAnalytics": true,
                          "title": "JVM Non-Heap Usage in MB",
                          "timeContext": {
                            "durationMs": 0
                          },
                          "timeContextFromParameter": "TimeRange",
                          "queryType": 0,
                          "resourceType": "microsoft.hdinsight/clusters",
                          "crossComponentResources": [
                            "{Cluster}"
                          ],
                          "visualization": "linechart",
                          "chartSettings": {
                            "ySettings": {
                              "numberFormatSettings": {
                                "unit": 4,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": true
                                }
                              }
                            }
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 0 - Copy"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "HDInsightHadoopAndYarnMetrics\r\n| where MetricNamespace contains '{Component}'\r\n| where MetricName == \"GcCount\"\r\n| where TimeGenerated {TimeRange}\r\n| make-series avg(MetricValue) default=double(null) on TimeGenerated in range({TimeRange:start} , {TimeRange:end}, {TimeRange:grain}) by HostName\r\n| extend filled_avg_metric_value = series_fill_forward(avg_MetricValue) \r\n| mv-expand TimeGenerated to typeof(datetime), filled_avg_metric_value to typeof(int)\r\n| order by HostName desc,TimeGenerated asc \r\n| extend RateOfChange = iif(prev(HostName) == HostName, (filled_avg_metric_value - prev(filled_avg_metric_value, 1))/60.0, 0.0)\r\n| project TimeGenerated, HostName, RateOfChange\r\n",
                          "size": 0,
                          "aggregation": 5,
                          "showAnalytics": true,
                          "title": "Garbage Collections By Host",
                          "timeContext": {
                            "durationMs": 0
                          },
                          "timeContextFromParameter": "TimeRange",
                          "queryType": 0,
                          "resourceType": "microsoft.hdinsight/clusters",
                          "crossComponentResources": [
                            "{Cluster}"
                          ],
                          "visualization": "linechart",
                          "chartSettings": {
                            "ySettings": {
                              "numberFormatSettings": {
                                "unit": 31,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": true
                                }
                              }
                            }
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 5"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "HDInsightHadoopAndYarnMetrics\r\n| where ClusterName == '{Cluster:label}' and MetricNamespace contains \"{Component}\" and MetricName contains \"Gc\"\r\n| evaluate pivot(MetricName, avg(MetricValue),TimeGenerated, ClusterName, HostName)\r\n| where TimeGenerated {TimeRange}\r\n| make-series avg(GcCount) default=double(null), avg(GcTimeMillis) default=double(null) on TimeGenerated in range({TimeRange:start} , {TimeRange:end}, {TimeRange:grain}) by HostName\r\n| extend filled_avg_count_value = series_fill_forward(avg_GcCount), filled_avg_time_value = series_fill_forward(avg_GcTimeMillis)\r\n| mv-expand TimeGenerated to typeof(datetime), filled_avg_count_value to typeof(double), filled_avg_time_value to typeof(double)\r\n| order by HostName desc,TimeGenerated asc \r\n| extend RateOfChange = iif(prev(HostName) == HostName, (filled_avg_time_value - prev(filled_avg_time_value, 1))/(filled_avg_count_value - prev(filled_avg_count_value, 1)) , 0.0)\r\n| extend RateOfChangeNoNan = iif(isnan(RateOfChange), 0.0, RateOfChange)\r\n| project TimeGenerated, HostName, RateOfChangeNoNan\r\n\r\n\r\n",
                          "size": 0,
                          "aggregation": 5,
                          "showAnalytics": true,
                          "title": "Mean Time Per Collection in MS",
                          "timeContext": {
                            "durationMs": 0
                          },
                          "timeContextFromParameter": "TimeRange",
                          "queryType": 0,
                          "resourceType": "microsoft.hdinsight/clusters",
                          "crossComponentResources": [
                            "{Cluster}"
                          ],
                          "visualization": "linechart",
                          "chartSettings": {
                            "ySettings": {
                              "numberFormatSettings": {
                                "unit": 23,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": true
                                }
                              }
                            }
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 4"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "yarn_tab",
                    "comparison": "isEqualTo",
                    "value": "JVM"
                  },
                  "name": "YARN JVM"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "YARN Timeline Server",
                    "items": [
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "HDInsightHadoopAndYarnMetrics\r\n| where ClusterName == '{Cluster:label}'\r\n| where MetricName == \"GetEntitiesTotal\"\r\n| project ClusterName, TimeGenerated, MetricValue",
                          "size": 0,
                          "aggregation": 5,
                          "showAnalytics": true,
                          "title": "Timeline Entity Data Reads",
                          "timeContext": {
                            "durationMs": 0
                          },
                          "timeContextFromParameter": "TimeRange",
                          "queryType": 0,
                          "resourceType": "microsoft.hdinsight/clusters",
                          "crossComponentResources": [
                            "{Cluster}"
                          ],
                          "visualization": "linechart"
                        },
                        "customWidth": "50",
                        "name": "Timeline Entity Data Reads"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "HDInsightHadoopAndYarnMetrics\r\n| where MetricName == \"GetEntitiesTimeAvgTime\"\r\n| project ClusterName, TimeGenerated, MetricValue",
                          "size": 0,
                          "aggregation": 5,
                          "showAnalytics": true,
                          "title": "Average Timeline Entity Data Read Time",
                          "timeContext": {
                            "durationMs": 0
                          },
                          "timeContextFromParameter": "TimeRange",
                          "queryType": 0,
                          "resourceType": "microsoft.hdinsight/clusters",
                          "crossComponentResources": [
                            "{Cluster}"
                          ],
                          "visualization": "linechart",
                          "chartSettings": {
                            "ySettings": {
                              "numberFormatSettings": {
                                "unit": 23,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": true
                                }
                              }
                            }
                          }
                        },
                        "customWidth": "50",
                        "name": "Average Timeline Entity Data Read Time"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "HDInsightHadoopAndYarnMetrics\r\n| where MetricName == \"PostEntitiesTotal\"\r\n| project ClusterName, TimeGenerated, MetricValue",
                          "size": 0,
                          "aggregation": 5,
                          "showAnalytics": true,
                          "title": "Timeline Entity Data Writes",
                          "timeContext": {
                            "durationMs": 0
                          },
                          "timeContextFromParameter": "TimeRange",
                          "queryType": 0,
                          "resourceType": "microsoft.hdinsight/clusters",
                          "crossComponentResources": [
                            "{Cluster}"
                          ],
                          "visualization": "linechart"
                        },
                        "customWidth": "50",
                        "name": "Timeline Entity Data Writes"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "HDInsightHadoopAndYarnMetrics\r\n| where MetricName == \"PostEntitiesTimeAvgTime\"\r\n| project ClusterName, TimeGenerated, MetricValue",
                          "size": 0,
                          "aggregation": 5,
                          "showAnalytics": true,
                          "title": "Average Timeline Entity Data Write Time",
                          "timeContext": {
                            "durationMs": 0
                          },
                          "timeContextFromParameter": "TimeRange",
                          "queryType": 0,
                          "resourceType": "microsoft.hdinsight/clusters",
                          "crossComponentResources": [
                            "{Cluster}"
                          ],
                          "visualization": "linechart",
                          "chartSettings": {
                            "ySettings": {
                              "numberFormatSettings": {
                                "unit": 23,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": true
                                }
                              }
                            }
                          }
                        },
                        "customWidth": "50",
                        "name": "Average Timeline Entity Data Write Time"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "yarn_tab",
                    "comparison": "isEqualTo",
                    "value": "TimelineServer"
                  },
                  "name": "YARN Timeline Server"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "tab",
              "comparison": "isEqualTo",
              "value": "Yarn"
            },
            "name": "Yarn"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 9,
                  "content": {
                    "version": "KqlParameterItem/1.0",
                    "parameters": [
                      {
                        "id": "3ec6cf7a-63dc-407f-ba90-444ccbd6a5db",
                        "version": "KqlParameterItem/1.0",
                        "name": "hive_usage",
                        "type": 1,
                        "isRequired": true,
                        "query": "let hasNonEmptyTable = (T:string, T2:string) \r\n{ \r\n   toscalar( \r\n   union isfuzzy=true \r\n   ( table(T) | take 1 | count as Count ),\r\n   ( table(T2) | take 1 | count as Count),\r\n   (print Count=0) \r\n   | summarize sum(Count) \r\n   ) > 1\r\n};\r\nlet TableName = 'HDInsightHiveLogs';\r\nlet TableName2 = 'HDInsightHiveMetrics';\r\nprint  IsPresent=iif(hasNonEmptyTable(TableName,TableName2 ), \"present\", \"not present\")",
                        "isHiddenWhenLocked": true,
                        "timeContext": {
                          "durationMs": 86400000
                        },
                        "queryType": 0,
                        "resourceType": "microsoft.hdinsight/clusters"
                      }
                    ],
                    "style": "pills",
                    "queryType": 0,
                    "resourceType": "microsoft.hdinsight/clusters"
                  },
                  "name": "parameters - 2"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "HDInsightHiveAndLLAPMetrics\r\n| where MetricName == \"NumActiveSources\"\r\n|project ClusterName,MetricName, TimeGenerated, MetricValue\r\n| order by TimeGenerated desc\r\n| take 1",
                          "size": 4,
                          "showAnalytics": true,
                          "timeContext": {
                            "durationMs": 300000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "queryType": 0,
                          "resourceType": "microsoft.hdinsight/clusters",
                          "crossComponentResources": [
                            "{Cluster}"
                          ],
                          "visualization": "tiles",
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "MetricName",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "MetricValue",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            },
                            "showBorder": false
                          }
                        },
                        "customWidth": "20",
                        "name": "query - 0"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "HDInsightHiveAndLLAPMetrics\r\n| where MetricName == \"NumActiveSinks\"\r\n|project ClusterName,MetricName, TimeGenerated, MetricValue\r\n| order by TimeGenerated desc\r\n| take 1",
                          "size": 4,
                          "showAnalytics": true,
                          "timeContext": {
                            "durationMs": 300000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "queryType": 0,
                          "resourceType": "microsoft.hdinsight/clusters",
                          "crossComponentResources": [
                            "{Cluster}"
                          ],
                          "visualization": "tiles",
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "MetricName",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "MetricValue",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            },
                            "showBorder": false
                          }
                        },
                        "customWidth": "20",
                        "name": "query - 0 - Copy"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "HDInsightHiveAndLLAPMetrics\r\n| where MetricName == \"Sink_timelineAvgTime\"\r\n|project ClusterName,MetricName, TimeGenerated, MetricValue\r\n| order by TimeGenerated desc\r\n| take 1",
                          "size": 4,
                          "showAnalytics": true,
                          "timeContext": {
                            "durationMs": 300000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "queryType": 0,
                          "resourceType": "microsoft.hdinsight/clusters",
                          "crossComponentResources": [
                            "{Cluster}"
                          ],
                          "visualization": "tiles",
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "MetricName",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "MetricValue",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 23,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": false,
                                  "maximumFractionDigits": 2,
                                  "maximumSignificantDigits": 3
                                }
                              }
                            },
                            "showBorder": false
                          }
                        },
                        "customWidth": "20",
                        "name": "query - 0 - Copy - Copy"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "HDInsightHiveAndLLAPMetrics\r\n| where MetricName == \"PublishAvgTime\"\r\n|project ClusterName,MetricName, TimeGenerated, MetricValue\r\n| order by TimeGenerated desc\r\n| take 1",
                          "size": 4,
                          "showAnalytics": true,
                          "timeContext": {
                            "durationMs": 300000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "queryType": 0,
                          "resourceType": "microsoft.hdinsight/clusters",
                          "crossComponentResources": [
                            "{Cluster}"
                          ],
                          "visualization": "tiles",
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "MetricName",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "MetricValue",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 23,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": false,
                                  "maximumFractionDigits": 2,
                                  "maximumSignificantDigits": 3
                                }
                              }
                            },
                            "showBorder": false
                          }
                        },
                        "customWidth": "20",
                        "name": "query - 0 - Copy - Copy - Copy"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "HDInsightHiveAndLLAPMetrics\r\n| where ClusterName == '{Cluster:label}'\r\n| where MetricName == \"SnapshotAvgTime\"\r\n|project ClusterName,MetricName, TimeGenerated, MetricValue\r\n| order by TimeGenerated desc\r\n| take 1",
                          "size": 4,
                          "showAnalytics": true,
                          "timeContext": {
                            "durationMs": 300000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "queryType": 0,
                          "resourceType": "microsoft.hdinsight/clusters",
                          "crossComponentResources": [
                            "{Cluster}"
                          ],
                          "visualization": "tiles",
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "MetricName",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "MetricValue",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 23,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": false,
                                  "maximumFractionDigits": 2,
                                  "maximumSignificantDigits": 3
                                }
                              }
                            },
                            "showBorder": false
                          }
                        },
                        "customWidth": "20",
                        "name": "query - 0 - Copy - Copy - Copy - Copy"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "HDInsightHiveAndLLAPMetrics\r\n| where MetricNamespace contains \"Hadoop:service=hiveserver2\"\r\n| where MetricName contains \"AvgTime\"\r\n| summarize avg(MetricValue) by MetricName, bin(TimeGenerated, {TimeRange:grain})",
                          "size": 0,
                          "aggregation": 5,
                          "showAnalytics": true,
                          "title": "Operation Average Latencies",
                          "timeContext": {
                            "durationMs": 300000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "queryType": 0,
                          "resourceType": "microsoft.hdinsight/clusters",
                          "crossComponentResources": [
                            "{Cluster}"
                          ],
                          "visualization": "linechart",
                          "chartSettings": {
                            "ySettings": {
                              "numberFormatSettings": {
                                "unit": 23,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": true
                                }
                              }
                            }
                          }
                        },
                        "name": "Operation Average Latencies"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "HDInsightHiveAndLLAPMetrics\r\n| where ClusterName == '{Cluster:label}'\r\n| where MetricNamespace contains \"Hadoop:service=hiveserver2\"\r\n| where MetricName contains \"NumOps\"\r\n| summarize avg(MetricValue) by MetricName, bin(TimeGenerated, {TimeRange:grain})",
                          "size": 0,
                          "aggregation": 5,
                          "showAnalytics": true,
                          "title": "Operation  Counts",
                          "timeContext": {
                            "durationMs": 300000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "queryType": 0,
                          "resourceType": "microsoft.hdinsight/clusters",
                          "crossComponentResources": [
                            "{Cluster}"
                          ],
                          "visualization": "linechart",
                          "chartSettings": {
                            "ySettings": {
                              "numberFormatSettings": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": true
                                }
                              }
                            }
                          }
                        },
                        "name": "Operation Counts"
                      }
                    ]
                  },
                  "conditionalVisibilities": [
                    {
                      "parameterName": "top_tab",
                      "comparison": "isEqualTo",
                      "value": "Hive"
                    },
                    {
                      "parameterName": "hive_usage",
                      "comparison": "isEqualTo",
                      "value": "present"
                    }
                  ],
                  "name": "Hive Server Interactive"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "Metrics and Logs are not flowing to the Hive tables. If the cluster is version 3.6, Hive Metrics are not available. Otherwise, there may be an issue with the pipeline preventing metrics and logs from reaching your workspace. ",
                          "style": "info"
                        },
                        "name": "text - 0"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "hive_usage",
                    "comparison": "isEqualTo",
                    "value": "not present"
                  },
                  "name": "Hive Metrics N/A"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "tab",
              "comparison": "isEqualTo",
              "value": "Hive"
            },
            "name": "Hive Wrapper"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 11,
                  "content": {
                    "version": "LinkItem/1.0",
                    "style": "tabs",
                    "links": [
                      {
                        "id": "cfa21d88-941d-45b9-bf7e-707a5686da2b",
                        "cellValue": "spark_tab",
                        "linkTarget": "parameter",
                        "linkLabel": "Overview",
                        "subTarget": "Overview",
                        "preText": "",
                        "style": "link"
                      },
                      {
                        "id": "9e2592b4-6356-4d3d-8e18-761016306e0b",
                        "cellValue": "spark_tab",
                        "linkTarget": "parameter",
                        "linkLabel": "Apps",
                        "subTarget": "Apps",
                        "style": "link"
                      },
                      {
                        "id": "45cef298-128c-4440-a901-748c6dd16da1",
                        "cellValue": "spark_tab",
                        "linkTarget": "parameter",
                        "linkLabel": "Jobs",
                        "subTarget": "Jobs",
                        "style": "link"
                      },
                      {
                        "id": "b0d6b46e-65a9-4b7f-9e4b-ded43375adcf",
                        "cellValue": "spark_tab",
                        "linkTarget": "parameter",
                        "linkLabel": "Stages",
                        "subTarget": "Stages",
                        "style": "link"
                      },
                      {
                        "id": "0c5fe07a-f012-4eb7-aa49-70c06f83c942",
                        "cellValue": "spark_tab",
                        "linkTarget": "parameter",
                        "linkLabel": "Tasks",
                        "subTarget": "Tasks",
                        "style": "link"
                      }
                    ]
                  },
                  "name": "links - 1"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "HDInsightHadoopAndYarnMetrics\r\n| where MetricName == \"AllocatedVCores\" and MetricNamespace != \"Hadoop:service=NodeManager,name=NodeManagerMetrics\"\r\n| summarize arg_max(TimeGenerated, *) by ClusterName, MetricNamespace\r\n| summarize AllocatedVCores = sum(MetricValue) by ClusterName\r\n| extend MetricName = \"AllocatedVCores\"",
                          "size": 4,
                          "showAnalytics": true,
                          "timeContext": {
                            "durationMs": 300000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "queryType": 0,
                          "resourceType": "microsoft.hdinsight/clusters",
                          "crossComponentResources": [
                            "{Cluster}"
                          ],
                          "visualization": "tiles",
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "MetricName",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "AllocatedVCores",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": false,
                                  "maximumFractionDigits": 2,
                                  "maximumSignificantDigits": 3
                                }
                              }
                            },
                            "showBorder": false
                          }
                        },
                        "customWidth": "25",
                        "name": "query - 0"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "HDInsightHadoopAndYarnMetrics\r\n| where ClusterName == \"{Cluster:label}\"\r\n| where MetricName == \"AllocatedMB\" and MetricNamespace != \"Hadoop:service=NodeManager,name=NodeManagerMetrics\"\r\n| summarize arg_max(TimeGenerated, *) by ClusterName, MetricNamespace\r\n| summarize AllocatedMB = sum(MetricValue) by ClusterName\r\n| extend MetricName = \"AllocatedMB\"",
                          "size": 4,
                          "showAnalytics": true,
                          "timeContext": {
                            "durationMs": 300000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "queryType": 0,
                          "resourceType": "microsoft.hdinsight/clusters",
                          "crossComponentResources": [
                            "{Cluster}"
                          ],
                          "visualization": "tiles",
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "MetricName",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "AllocatedMB",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 4,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": false,
                                  "maximumFractionDigits": 2,
                                  "maximumSignificantDigits": 3
                                }
                              }
                            },
                            "showBorder": false
                          }
                        },
                        "customWidth": "25",
                        "name": "query - 0 - Copy - Copy"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "HDInsightHadoopAndYarnMetrics\r\n| where MetricName == \"AppsRunning\" and MetricNamespace != \"Hadoop:service=NodeManager,name=NodeManagerMetrics\"\r\n| summarize arg_max(TimeGenerated, *) by ClusterName, MetricNamespace\r\n| summarize AppsRunning = sum(MetricValue) by ClusterName\r\n| extend MetricName = \"AppsRunning\"",
                          "size": 4,
                          "showAnalytics": true,
                          "timeContext": {
                            "durationMs": 300000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "queryType": 0,
                          "resourceType": "microsoft.hdinsight/clusters",
                          "crossComponentResources": [
                            "{Cluster}"
                          ],
                          "visualization": "tiles",
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "MetricName",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "AppsRunning",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 0,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": false,
                                  "maximumFractionDigits": 2,
                                  "maximumSignificantDigits": 3
                                }
                              }
                            },
                            "showBorder": false
                          }
                        },
                        "customWidth": "25",
                        "name": "query - 0 - Copy - Copy - Copy - Copy"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "HDInsightHadoopAndYarnMetrics\r\n| where MetricName == \"AppsFailed\" and MetricNamespace != \"Hadoop:service=NodeManager,name=NodeManagerMetrics\"\r\n| summarize arg_max(TimeGenerated, *) by ClusterName, MetricNamespace\r\n| summarize AppsFailed = sum(MetricValue) by ClusterName\r\n| take 1\r\n| extend MetricName = \"AppsFailed\"",
                          "size": 4,
                          "showAnalytics": true,
                          "timeContext": {
                            "durationMs": 300000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "queryType": 0,
                          "resourceType": "microsoft.hdinsight/clusters",
                          "crossComponentResources": [
                            "{Cluster}"
                          ],
                          "visualization": "tiles",
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "MetricName",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "AppsFailed",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 0,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": false,
                                  "maximumFractionDigits": 2,
                                  "maximumSignificantDigits": 3
                                }
                              }
                            },
                            "showBorder": false
                          }
                        },
                        "customWidth": "25",
                        "name": "query - 0 - Copy - Copy - Copy - Copy - Copy"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "HDInsightHadoopAndYarnMetrics\r\n| where ClusterName == \"{Cluster:label}\"\r\n| where MetricNamespace != \"Hadoop:service=NodeManager,name=NodeManagerMetrics\" and (MetricName == \"AllocatedVCores\" or MetricName == \"AvailableVCores\" or MetricName == \"PendingVCores\" or MetricName == \"ReservedVCores\")\r\n| summarize VCoresTotal = sum(MetricValue) by MetricName, TimeGenerated\r\n| top 10000 by TimeGenerated desc",
                          "size": 0,
                          "aggregation": 5,
                          "showAnalytics": true,
                          "title": "VCore Statuses",
                          "timeContext": {
                            "durationMs": 300000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "queryType": 0,
                          "resourceType": "microsoft.hdinsight/clusters",
                          "crossComponentResources": [
                            "{Cluster}"
                          ],
                          "visualization": "linechart"
                        },
                        "name": "query - 4"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "HDInsightHadoopAndYarnMetrics\r\n| where ClusterName == \"{Cluster:label}\"\r\n| where MetricNamespace != \"Hadoop:service=NodeManager,name=NodeManagerMetrics\" and (MetricName == \"AppsRunning\" or MetricName == \"AppsPending\")\r\n| summarize sum(MetricValue) by MetricName, TimeGenerated\r\n| top 10000 by TimeGenerated desc",
                          "size": 0,
                          "aggregation": 5,
                          "showAnalytics": true,
                          "title": "Active Application Statuses",
                          "timeContext": {
                            "durationMs": 300000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "queryType": 0,
                          "resourceType": "microsoft.hdinsight/clusters",
                          "crossComponentResources": [
                            "{Cluster}"
                          ],
                          "visualization": "linechart"
                        },
                        "customWidth": "50",
                        "name": "query - 4 - Copy"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "HDInsightHadoopAndYarnMetrics\r\n| where MetricNamespace != \"Hadoop:service=NodeManager,name=NodeManagerMetrics\" and (MetricName == \"AppsFailed\" or MetricName == \"AppsKilled\" or MetricName == \"AppsCompleted\")\r\n| summarize sum(MetricValue) by MetricName, TimeGenerated\r\n| top 10000 by TimeGenerated desc",
                          "size": 0,
                          "aggregation": 5,
                          "showAnalytics": true,
                          "title": "Completed Application Statuses",
                          "timeContext": {
                            "durationMs": 300000
                          },
                          "timeContextFromParameter": "TimeRange",
                          "queryType": 0,
                          "resourceType": "microsoft.hdinsight/clusters",
                          "crossComponentResources": [
                            "{Cluster}"
                          ],
                          "visualization": "barchart"
                        },
                        "customWidth": "50",
                        "name": "query - 4 - Copy - Copy"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "spark_tab",
                    "comparison": "isEqualTo",
                    "value": "Overview"
                  },
                  "name": "Overview"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "HDInsightSparkApplicationEvents\r\n| where ClusterDnsName == \"{Cluster:label}\"\r\n| where isnotnull(SubmissionTime)\r\n| summarize arg_max(toint(AppAttemptId),*) by ApplicationId\r\n| join kind=leftouter (\r\n    HDInsightSparkApplicationEvents\r\n    | where ClusterDnsName == \"{Cluster:label}\"\r\n    | where isnotnull(CompletionTime) \r\n) on ApplicationId\r\n| join kind=leftouter(\r\n    HDInsightSparkEnvironmentEvents\r\n    | where ClusterDnsName == \"{Cluster:label}\"\r\n    | project ApplicationId, SparkExecutorInstances, SparkExecutorCores, SparkExecutorMemory\r\n) on ApplicationId\r\n|order by SubmissionTime asc \r\n| extend CompletionTime = CompletionTime1\r\n| extend DurationMS = iff(isempty(CompletionTime), \"In Progress\", tostring(datetime_diff(\"Millisecond\",CompletionTime, SubmissionTime)))\r\n| project TimeGenerated, ApplicationId, AppName, SparkUser, AppAttemptId, DurationMS, SparkExecutorInstances, SparkExecutorCores, SparkExecutorMemory\r\n",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Application Statuses",
                          "timeContext": {
                            "durationMs": 0
                          },
                          "timeContextFromParameter": "TimeRange",
                          "queryType": 0,
                          "resourceType": "microsoft.hdinsight/clusters",
                          "crossComponentResources": [
                            "{Cluster}"
                          ],
                          "visualization": "table",
                          "sortBy": []
                        },
                        "name": "Application Statuses"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "spark_tab",
                    "comparison": "isEqualTo",
                    "value": "Apps"
                  },
                  "name": "Applications"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "crossComponentResources": [
                            "{Cluster}"
                          ],
                          "parameters": [
                            {
                              "id": "7ac9facd-0734-4ea8-aa35-26f0eace5b99",
                              "version": "KqlParameterItem/1.0",
                              "name": "ApplicationId",
                              "type": 2,
                              "isRequired": true,
                              "query": "HDInsightSparkJobEvents\r\n| summarize arg_max(TimeGenerated,*) by ApplicationId\r\n| project ApplicationId",
                              "crossComponentResources": [
                                "{Cluster}"
                              ],
                              "value": "value::1",
                              "typeSettings": {
                                "additionalResourceOptions": [
                                  "value::1"
                                ],
                                "showDefault": false
                              },
                              "timeContext": {
                                "durationMs": 0
                              },
                              "timeContextFromParameter": "TimeRange",
                              "queryType": 0,
                              "resourceType": "microsoft.hdinsight/clusters"
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.hdinsight/clusters"
                        },
                        "name": "parameters - 1"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "HDInsightSparkJobEvents\r\n| where ApplicationId == \"{ApplicationId}\"\r\n| summarize arg_max(TimeGenerated, *) by ApplicationId, JobId\r\n| summarize TotalNumOfJobs = count()\r\n| extend Name = \"TotalNumOfJobs\"",
                          "size": 4,
                          "showAnalytics": true,
                          "noDataMessage": "No jobs have run in this time range",
                          "timeContext": {
                            "durationMs": 0
                          },
                          "timeContextFromParameter": "TimeRange",
                          "queryType": 0,
                          "resourceType": "microsoft.hdinsight/clusters",
                          "crossComponentResources": [
                            "{Cluster}"
                          ],
                          "visualization": "tiles",
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "Name"
                            },
                            "leftContent": {
                              "columnMatch": "TotalNumOfJobs",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "blue"
                              }
                            },
                            "showBorder": false
                          }
                        },
                        "customWidth": "25",
                        "name": "query - 2"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "HDInsightSparkJobEvents\r\n| where ApplicationId == \"{ApplicationId}\" and isnotempty(JobResult)  \r\n| summarize JobsSucceeded = count() by JobResult\r\n",
                          "size": 1,
                          "showAnalytics": true,
                          "title": "Job Results",
                          "noDataMessage": "No Jobs have finished in this time range",
                          "timeContext": {
                            "durationMs": 0
                          },
                          "timeContextFromParameter": "TimeRange",
                          "queryType": 0,
                          "resourceType": "microsoft.hdinsight/clusters",
                          "crossComponentResources": [
                            "{Cluster}"
                          ],
                          "visualization": "piechart",
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "Name"
                            },
                            "leftContent": {
                              "columnMatch": "JobsSucceeded",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "blue"
                              }
                            },
                            "showBorder": false
                          },
                          "chartSettings": {
                            "createOtherGroup": null
                          }
                        },
                        "customWidth": "75",
                        "name": "query - 2 - Copy"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "HDInsightSparkJobEvents\r\n| where ApplicationId == \"{ApplicationId}\"\r\n| where isnotnull(SubmissionTime)\r\n| join kind=fullouter (\r\n    HDInsightSparkJobEvents\r\n    | where ApplicationId == \"{ApplicationId}\"\r\n    | where isnotnull(CompletionTime) \r\n) on ApplicationId, JobId\r\n| extend JobId = toint(JobId)\r\n|order by ApplicationId, JobId asc \r\n| extend CompletionTime = CompletionTime1\r\n| extend JobResult = JobResult1\r\n| extend Duration = iff(isempty(CompletionTime), \"In Progress\", tostring(datetime_diff(\"Millisecond\",CompletionTime, SubmissionTime)))\r\n| project TimeGenerated, ApplicationId, JobId, Duration, JobResult, StageIds\r\n",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Jobs Statuses",
                          "timeContext": {
                            "durationMs": 0
                          },
                          "timeContextFromParameter": "TimeRange",
                          "queryType": 0,
                          "resourceType": "microsoft.hdinsight/clusters",
                          "crossComponentResources": [
                            "{Cluster}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "DurationMS",
                                "formatter": 0,
                                "numberFormat": {
                                  "unit": 23,
                                  "options": {
                                    "style": "decimal",
                                    "useGrouping": false
                                  }
                                }
                              },
                              {
                                "columnMatch": "Duration",
                                "formatter": 0,
                                "numberFormat": {
                                  "unit": 23,
                                  "options": {
                                    "style": "decimal",
                                    "useGrouping": false
                                  }
                                }
                              }
                            ],
                            "sortBy": [
                              {
                                "itemKey": "JobResult",
                                "sortOrder": 1
                              }
                            ]
                          },
                          "sortBy": [
                            {
                              "itemKey": "JobResult",
                              "sortOrder": 1
                            }
                          ]
                        },
                        "name": "Jobs Statuses"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "crossComponentResources": [
                            "{Cluster}"
                          ],
                          "parameters": [
                            {
                              "id": "20d79d73-de67-407d-88fa-674905983ac2",
                              "version": "KqlParameterItem/1.0",
                              "name": "MetricName",
                              "type": 2,
                              "isRequired": true,
                              "query": "HDInsightSparkJobEvents\r\n| where ApplicationId == \"{ApplicationId}\"\r\n| extend Stages = split(StageIds,\",\")\r\n| mvexpand(Stages)\r\n| extend Stages = trim(\" \",tostring(Stages))\r\n| join (HDInsightSparkStageTaskAccumulables \r\n| where ApplicationId == \"{ApplicationId}\"\r\n| where Entity == \"stage\"\r\n) on $left.Stages == $right.EntityId\r\n| distinct MetricName\r\n| extend MetricName = iff(MetricName startswith(\"internal.metrics\"), substring(MetricName, 17), MetricName)",
                              "crossComponentResources": [
                                "{Cluster}"
                              ],
                              "typeSettings": {
                                "additionalResourceOptions": [
                                  "value::1"
                                ],
                                "showDefault": false
                              },
                              "timeContext": {
                                "durationMs": 5184000000
                              },
                              "timeContextFromParameter": "TimeRange",
                              "defaultValue": "value::1",
                              "queryType": 0,
                              "resourceType": "microsoft.hdinsight/clusters"
                            },
                            {
                              "id": "d8168623-f107-41bb-afa5-8563bb30d57a",
                              "version": "KqlParameterItem/1.0",
                              "name": "NumberOfJobs",
                              "type": 1,
                              "isRequired": true,
                              "value": "10"
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.hdinsight/clusters"
                        },
                        "name": "parameters - 1"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "HDInsightSparkJobEvents\r\n| where ClusterDnsName == \"{Cluster:label}\"\r\n| where ApplicationId == \"{ApplicationId}\"\r\n| extend Stages = split(StageIds,\",\")\r\n| mvexpand(Stages)\r\n| extend Stages = trim(\" \",tostring(Stages))\r\n| join (HDInsightSparkStageTaskAccumulables \r\n| where ClusterDnsName == \"{Cluster:label}\"\r\n| where ApplicationId == \"{ApplicationId}\"\r\n| where Entity == \"stage\" and MetricName contains \"{MetricName}\"\r\n) on $left.Stages == $right.EntityId\r\n| summarize JobTotalMetricValue=sum(MetricValue) by ApplicationId, JobId, MetricName, bin(TimeGenerated, {TimeRange:grain})\r\n| project ApplicationId, JobId, JobTotalMetricValue\r\n| top {NumberOfJobs} by JobTotalMetricValue\r\n\r\n\r\n\r\n",
                          "size": 1,
                          "title": "Jobs with Top Metric Value",
                          "timeContext": {
                            "durationMs": 0
                          },
                          "timeContextFromParameter": "TimeRange",
                          "queryType": 0,
                          "resourceType": "microsoft.hdinsight/clusters",
                          "crossComponentResources": [
                            "{Cluster}"
                          ]
                        },
                        "name": "query - 6"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "crossComponentResources": [
                            "{Cluster}"
                          ],
                          "parameters": [
                            {
                              "id": "fc1e2ede-0e0c-46f7-ae0f-546c95e164e1",
                              "version": "KqlParameterItem/1.0",
                              "name": "JobId",
                              "type": 2,
                              "isRequired": true,
                              "query": "HDInsightSparkJobEvents\r\n| where ApplicationId == \"{ApplicationId}\"\r\n| distinct JobId\r\n| extend JobId = toint(JobId)\r\n| order by JobId asc",
                              "crossComponentResources": [
                                "{Cluster}"
                              ],
                              "typeSettings": {
                                "additionalResourceOptions": [
                                  "value::1"
                                ],
                                "showDefault": false
                              },
                              "timeContext": {
                                "durationMs": 0
                              },
                              "timeContextFromParameter": "TimeRange",
                              "defaultValue": "value::1",
                              "queryType": 0,
                              "resourceType": "microsoft.hdinsight/clusters"
                            },
                            {
                              "id": "3e45add8-e1b4-4fd9-aa02-25c1b022b48a",
                              "version": "KqlParameterItem/1.0",
                              "name": "StageComparisonMetric",
                              "type": 2,
                              "query": "HDInsightSparkJobEvents\r\n| where ApplicationId == \"{ApplicationId}\" and JobId == \"{JobId}\"\r\n| extend Stages = split(StageIds,\",\")\r\n| mvexpand(Stages)\r\n| extend Stages = trim(\" \",tostring(Stages))\r\n| join (HDInsightSparkStageTaskAccumulables \r\n| where ApplicationId == \"{ApplicationId}\"\r\n| where Entity == \"stage\"\r\n) on $left.Stages == $right.EntityId\r\n| distinct MetricName\r\n| extend MetricName = iff(MetricName startswith(\"internal.metrics\"), substring(MetricName, 17), MetricName)",
                              "crossComponentResources": [
                                "{Cluster}"
                              ],
                              "value": "value::1",
                              "typeSettings": {
                                "additionalResourceOptions": [
                                  "value::1"
                                ],
                                "showDefault": false
                              },
                              "timeContext": {
                                "durationMs": 0
                              },
                              "timeContextFromParameter": "TimeRange",
                              "queryType": 0,
                              "resourceType": "microsoft.hdinsight/clusters"
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.hdinsight/clusters"
                        },
                        "name": "parameters - 7"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "HDInsightSparkJobEvents\r\n| where ClusterDnsName == \"{Cluster:label}\"\r\n| where ApplicationId == \"{ApplicationId}\" and JobId == \"{JobId}\"\r\n| extend Stages = split(StageIds,\",\")\r\n| mvexpand(Stages)\r\n| extend Stages = trim(\" \",tostring(Stages))\r\n| join kind=leftouter (HDInsightSparkStageTaskAccumulables \r\n| where ClusterDnsName == \"{Cluster:label}\"\r\n| where ApplicationId == \"{ApplicationId}\"\r\n| where Entity == \"stage\" and MetricName contains \"{StageComparisonMetric}\"\r\n) on $left.Stages == $right.EntityId\r\n| where isnotempty(Stages) \r\n| extend StagesDisplay = strcat(\"Stage \", Stages)\r\n| extend MetricName=\"{StageComparisonMetric}\", MetricValue = iff(isnotnull(MetricValue), MetricValue, 0)\r\n| project TimeGenerated, ApplicationId, StagesDisplay, MetricName, MetricValue\r\n\r\n\r\n\r\n",
                          "size": 0,
                          "aggregation": 5,
                          "showAnalytics": true,
                          "title": "Stages Metric Comparison",
                          "timeContext": {
                            "durationMs": 0
                          },
                          "timeContextFromParameter": "TimeRange",
                          "queryType": 0,
                          "resourceType": "microsoft.hdinsight/clusters",
                          "crossComponentResources": [
                            "{Cluster}"
                          ],
                          "visualization": "unstackedbar",
                          "chartSettings": {
                            "yAxis": [
                              "MetricValue"
                            ],
                            "group": "StagesDisplay",
                            "createOtherGroup": null,
                            "showLegend": true,
                            "ySettings": {
                              "numberFormatSettings": {
                                "unit": 0,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": true
                                }
                              }
                            }
                          }
                        },
                        "name": "query - 0"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "spark_tab",
                    "comparison": "isEqualTo",
                    "value": "Jobs"
                  },
                  "name": "Jobs"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "crossComponentResources": [
                            "{Cluster}"
                          ],
                          "parameters": [
                            {
                              "id": "09509ec4-8108-4ec0-9e36-8849d9b2ceba",
                              "version": "KqlParameterItem/1.0",
                              "name": "ApplicationId",
                              "type": 2,
                              "isRequired": true,
                              "query": "HDInsightSparkStageTaskAccumulables\r\n| where ClusterDnsName == \"{Cluster:label}\"\r\n| summarize arg_max(TimeGenerated,*) by ApplicationId\r\n| project ApplicationId",
                              "crossComponentResources": [
                                "{Cluster}"
                              ],
                              "value": "application_1605768758033_0002",
                              "typeSettings": {
                                "additionalResourceOptions": [
                                  "value::1"
                                ],
                                "showDefault": false
                              },
                              "timeContext": {
                                "durationMs": 5184000000
                              },
                              "timeContextFromParameter": "TimeRange",
                              "queryType": 0,
                              "resourceType": "microsoft.hdinsight/clusters"
                            },
                            {
                              "id": "e5664be5-9f11-4eb1-8f77-00491e0d953d",
                              "version": "KqlParameterItem/1.0",
                              "name": "JobId",
                              "type": 2,
                              "isRequired": true,
                              "query": "HDInsightSparkJobEvents\r\n| where ApplicationId == \"{ApplicationId}\"\r\n| distinct JobId\r\n| extend JobId = toint(JobId)\r\n| order by JobId asc",
                              "crossComponentResources": [
                                "{Cluster}"
                              ],
                              "value": "0",
                              "typeSettings": {
                                "additionalResourceOptions": [
                                  "value::1"
                                ],
                                "showDefault": false
                              },
                              "timeContext": {
                                "durationMs": 5184000000
                              },
                              "timeContextFromParameter": "TimeRange",
                              "queryType": 0,
                              "resourceType": "microsoft.hdinsight/clusters"
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.hdinsight/clusters"
                        },
                        "customWidth": "50",
                        "name": "parameters - 1 - Copy"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "HDInsightSparkJobEvents\r\n| where ClusterDnsName == \"{Cluster:label}\"\r\n| where ApplicationId == \"{ApplicationId}\" and JobId == \"{JobId}\"\r\n| extend Stages = split(StageIds,\",\")\r\n| mvexpand(Stages)\r\n| extend Stages = trim(\" \",tostring(Stages))\r\n| join  kind=leftouter (HDInsightSparkStageTaskAccumulables \r\n| where ClusterDnsName == \"{Cluster:label}\"\r\n| where ApplicationId == \"{ApplicationId}\"\r\n| where Entity == \"stage\" and (MetricName contains \"internal.metrics.output.bytesWritten\" or MetricName contains \"internal.metrics.input.bytesRead\" or MetricName contains \"number of output rows\")\r\n| extend MetricName = iff(MetricName startswith(\"internal.metrics\"), substring(MetricName, 17), MetricName)\r\n| evaluate pivot(MetricName, avg(MetricValue), TimeGenerated, EntityId)\r\n) on $left.Stages == $right.EntityId\r\n| extend InputBytesRead=column_ifexists(\"input.bytesRead\",0.0), OutputBytesWritten=column_ifexists(\"output.bytesWritten\",0.0), NumberOfOutputRows=column_ifexists(\"number of output rows\", 0.0)\r\n| extend InputBytesRead=iff(isnotnull(InputBytesRead), InputBytesRead, 0.0), OutputBytesWritten=iff(isnotnull(OutputBytesWritten), OutputBytesWritten, 0.0), NumberOfOutputRows=iff(isnotnull(NumberOfOutputRows), NumberOfOutputRows, 0.0)\r\n| extend InputBytesRead=iff(isnan(InputBytesRead),0.0, InputBytesRead), OutputBytesWritten=iff(isnan(OutputBytesWritten),0.0, OutputBytesWritten), NumberOfOutputRows=iff(isnan(NumberOfOutputRows), 0.0, NumberOfOutputRows)\r\n| join kind=leftouter (HDInsightSparkTaskEvents\r\n| where ApplicationId == \"{ApplicationId}\"\r\n| summarize NumberOfTasks=dcount(TaskId) by ApplicationId, StageId)\r\non $left.Stages== $right.StageId\r\n| join kind=leftouter (HDInsightSparkStageEvents\r\n| where ApplicationId == \"{ApplicationId}\"\r\n| where isnotempty(CompletionTime)\r\n| extend Duration = iff(isnotempty(CompletionTime), datetime_diff(\"Millisecond\", CompletionTime, SubmissionTime), datetime_diff(\"Millisecond\", now(), SubmissionTime))\r\n) on $left.Stages == $right.StageId\r\n| join kind=leftouter (HDInsightSparkStageEvents\r\n| where ApplicationId == \"{ApplicationId}\"\r\n| where isempty(CompletionTime)\r\n| project StageId, StageName\r\n) on $left.Stages == $right.StageId\r\n| extend Stage = strcat(\"Stage \", Stages)\r\n| where isnotempty(Stages)\r\n| project TimeGenerated, ApplicationId, Stage, StageName=StageName1, Duration, NumberOfTasks, InputBytesRead, OutputBytesWritten, NumberOfOutputRows \r\n\r\n\r\n\r\n\r\n",
                          "size": 1,
                          "showAnalytics": true,
                          "title": "Stage Overview",
                          "timeContext": {
                            "durationMs": 0
                          },
                          "timeContextFromParameter": "TimeRange",
                          "queryType": 0,
                          "resourceType": "microsoft.hdinsight/clusters",
                          "crossComponentResources": [
                            "{Cluster}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "Duration",
                                "formatter": 0,
                                "numberFormat": {
                                  "unit": 23,
                                  "options": {
                                    "style": "decimal",
                                    "useGrouping": false
                                  }
                                }
                              },
                              {
                                "columnMatch": "InputBytesRead",
                                "formatter": 0,
                                "numberFormat": {
                                  "unit": 2,
                                  "options": {
                                    "style": "decimal"
                                  }
                                }
                              },
                              {
                                "columnMatch": "OutputBytesWritten",
                                "formatter": 0,
                                "numberFormat": {
                                  "unit": 2,
                                  "options": {
                                    "style": "decimal",
                                    "useGrouping": false
                                  }
                                }
                              }
                            ]
                          }
                        },
                        "name": "query - 2"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "crossComponentResources": [
                            "{Cluster}"
                          ],
                          "parameters": [
                            {
                              "id": "e7d0a191-3198-47e5-acda-217c00ef2433",
                              "version": "KqlParameterItem/1.0",
                              "name": "StageId",
                              "type": 2,
                              "isRequired": true,
                              "query": "HDInsightSparkJobEvents\r\n| where ClusterDnsName == \"{Cluster:label}\"\r\n| where ApplicationId == \"{ApplicationId}\" and JobId == \"{JobId}\"\r\n| extend Stages = split(StageIds,\",\")\r\n| mvexpand(Stages)\r\n| extend Stages = trim(\" \",tostring(Stages))\r\n| where isnotempty(Stages)\r\n| distinct Stages\r\n| extend Stages = toint(Stages)\r\n| order by Stages asc",
                              "crossComponentResources": [
                                "{Cluster}"
                              ],
                              "value": "0",
                              "typeSettings": {
                                "additionalResourceOptions": [
                                  "value::1"
                                ],
                                "showDefault": false
                              },
                              "timeContext": {
                                "durationMs": 0
                              },
                              "timeContextFromParameter": "TimeRange",
                              "queryType": 0,
                              "resourceType": "microsoft.hdinsight/clusters"
                            },
                            {
                              "id": "e0e100e1-a19c-4bea-bf3e-7df9190d4946",
                              "version": "KqlParameterItem/1.0",
                              "name": "MetricName",
                              "type": 2,
                              "isRequired": true,
                              "query": "HDInsightSparkStageTaskAccumulables \r\n| where ApplicationId == \"{ApplicationId}\" and ParentId == \"{StageId}\"\r\n| where Entity == \"task\"\r\n| distinct MetricName\r\n| extend MetricName = iff(MetricName startswith(\"internal.metrics\"), substring(MetricName, 17), MetricName)",
                              "crossComponentResources": [
                                "{Cluster}"
                              ],
                              "value": "input.recordsRead",
                              "typeSettings": {
                                "additionalResourceOptions": [
                                  "value::1"
                                ],
                                "showDefault": false
                              },
                              "timeContext": {
                                "durationMs": 0
                              },
                              "timeContextFromParameter": "TimeRange",
                              "queryType": 0,
                              "resourceType": "microsoft.hdinsight/clusters"
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.hdinsight/clusters"
                        },
                        "name": "parameters - 2"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "HDInsightSparkTaskEvents\r\n| where ClusterDnsName == \"{Cluster:label}\" and ApplicationId == \"{ApplicationId}\" and StageId == \"{StageId}\"\r\n| summarize TaskCount= dcount(TaskId), SucceededTasks= countif(EndReason==\"Success\"), TaskTypes=dcount(TaskType), BytesRead=sum(BytesRead), BytesWritten=sum(BytesWritten) by ApplicationId, StageId\r\n",
                          "size": 4,
                          "showAnalytics": true,
                          "title": "Stage Details",
                          "timeContext": {
                            "durationMs": 0
                          },
                          "timeContextFromParameter": "TimeRange",
                          "queryType": 0,
                          "resourceType": "microsoft.hdinsight/clusters",
                          "crossComponentResources": [
                            "{Cluster}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "BytesRead",
                                "formatter": 0,
                                "numberFormat": {
                                  "unit": 2,
                                  "options": {
                                    "style": "decimal",
                                    "useGrouping": false
                                  }
                                }
                              },
                              {
                                "columnMatch": "BytesWritten",
                                "formatter": 0,
                                "numberFormat": {
                                  "unit": 2,
                                  "options": {
                                    "style": "decimal"
                                  }
                                }
                              }
                            ]
                          }
                        },
                        "name": "query - 3"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "HDInsightSparkStageTaskAccumulables \r\n| where ApplicationId == \"{ApplicationId}\" and ParentId == \"{StageId}\"\r\n| where Entity == \"task\" and MetricName contains \"{MetricName}\"\r\n| extend TasksDisplay = strcat(\"Task \", EntityId)\r\n| project TimeGenerated, ApplicationId, TasksDisplay, MetricName, MetricValue\r\n| top 10 by MetricValue\r\n\r\n\r\n\r\n",
                          "size": 0,
                          "aggregation": 5,
                          "showAnalytics": true,
                          "title": "Top 10 Tasks of Specified Metric Value",
                          "timeContext": {
                            "durationMs": 0
                          },
                          "timeContextFromParameter": "TimeRange",
                          "queryType": 0,
                          "resourceType": "microsoft.hdinsight/clusters",
                          "crossComponentResources": [
                            "{Cluster}"
                          ],
                          "visualization": "unstackedbar",
                          "chartSettings": {
                            "group": "TasksDisplay",
                            "createOtherGroup": 0
                          }
                        },
                        "name": "query - 4"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "spark_tab",
                    "comparison": "isEqualTo",
                    "value": "Stages"
                  },
                  "name": "Stage"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "crossComponentResources": [
                            "{Cluster}"
                          ],
                          "parameters": [
                            {
                              "id": "709c6263-0b4e-47c1-986a-e7321892b270",
                              "version": "KqlParameterItem/1.0",
                              "name": "ApplicationId",
                              "type": 2,
                              "isRequired": true,
                              "query": "HDInsightSparkStageTaskAccumulables\r\n| summarize arg_max(TimeGenerated,*) by ApplicationId\r\n| project ApplicationId",
                              "crossComponentResources": [
                                "{Cluster}"
                              ],
                              "value": "application_1605768758033_0002",
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "timeContext": {
                                "durationMs": 0
                              },
                              "timeContextFromParameter": "TimeRange",
                              "queryType": 0,
                              "resourceType": "microsoft.hdinsight/clusters"
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.hdinsight/clusters"
                        },
                        "name": "parameters - 1 - Copy - Copy"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "HDInsightSparkTaskEvents\r\n| where ApplicationId == \"{ApplicationId}\"\r\n| summarize count() by TaskType",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Task Types",
                          "timeContext": {
                            "durationMs": 0
                          },
                          "timeContextFromParameter": "TimeRange",
                          "queryType": 0,
                          "resourceType": "microsoft.hdinsight/clusters",
                          "crossComponentResources": [
                            "{Cluster}"
                          ],
                          "visualization": "piechart"
                        },
                        "customWidth": "50",
                        "name": "query - 5"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "HDInsightSparkTaskEvents\r\n| where ApplicationId == \"{ApplicationId}\"\r\n| summarize count() by EndReason",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Task Results",
                          "timeContext": {
                            "durationMs": 0
                          },
                          "timeContextFromParameter": "TimeRange",
                          "queryType": 0,
                          "resourceType": "microsoft.hdinsight/clusters",
                          "crossComponentResources": [
                            "{Cluster}"
                          ],
                          "visualization": "piechart"
                        },
                        "customWidth": "50",
                        "name": "query - 5 - Copy"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "HDInsightSparkTaskEvents \r\n| where ClusterDnsName == '{Cluster:label}'\r\n| where ApplicationId == '{ApplicationId}'\r\n|project ApplicationId, StageId, TaskId, AttemptId, ExecutorId, ExecutorRunTime\r\n| top 10 by ExecutorRunTime",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Executor Run Time by Task",
                          "timeContext": {
                            "durationMs": 0
                          },
                          "timeContextFromParameter": "TimeRange",
                          "queryType": 0,
                          "resourceType": "microsoft.hdinsight/clusters",
                          "crossComponentResources": [
                            "{Cluster}"
                          ],
                          "visualization": "unstackedbar",
                          "chartSettings": {
                            "xAxis": "TaskId",
                            "createOtherGroup": 0,
                            "ySettings": {
                              "numberFormatSettings": {
                                "unit": 23,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": true
                                }
                              }
                            }
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 0 - Copy"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "HDInsightSparkTaskEvents \r\n| where ClusterDnsName == '{Cluster:label}'\r\n| where ApplicationId == '{ApplicationId}'\r\n|project ApplicationId, StageId, TaskId, AttemptId, ExecutorId, JvmGcTime\r\n| top 10 by JvmGcTime",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Jvm Gc Time by Task",
                          "timeContext": {
                            "durationMs": 0
                          },
                          "timeContextFromParameter": "TimeRange",
                          "queryType": 0,
                          "resourceType": "microsoft.hdinsight/clusters",
                          "crossComponentResources": [
                            "{Cluster}"
                          ],
                          "visualization": "unstackedbar",
                          "chartSettings": {
                            "xAxis": "TaskId",
                            "ySettings": {
                              "numberFormatSettings": {
                                "unit": 23,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": true
                                }
                              }
                            }
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 0"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "HDInsightSparkTaskEvents \r\n| where ApplicationId == '{ApplicationId}'\r\n|project ApplicationId, StageId, TaskId, AttemptId, ExecutorId, BytesWritten\r\n| top 10 by BytesWritten",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Bytes Written by Task",
                          "timeContext": {
                            "durationMs": 0
                          },
                          "timeContextFromParameter": "TimeRange",
                          "queryType": 0,
                          "resourceType": "microsoft.hdinsight/clusters",
                          "crossComponentResources": [
                            "{Cluster}"
                          ],
                          "visualization": "unstackedbar",
                          "chartSettings": {
                            "xAxis": "TaskId",
                            "ySettings": {
                              "numberFormatSettings": {
                                "unit": 2,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": true
                                }
                              }
                            }
                          }
                        },
                        "customWidth": "50",
                        "name": "Bytes Written by Task"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "HDInsightSparkTaskEvents \r\n| where ClusterDnsName == '{Cluster:label}'\r\n| where ApplicationId == '{ApplicationId}'\r\n|project ApplicationId, StageId, TaskId, AttemptId, ExecutorId, BytesRead\r\n| top 10 by BytesRead",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Bytes Read by Task",
                          "timeContext": {
                            "durationMs": 0
                          },
                          "timeContextFromParameter": "TimeRange",
                          "queryType": 0,
                          "resourceType": "microsoft.hdinsight/clusters",
                          "crossComponentResources": [
                            "{Cluster}"
                          ],
                          "visualization": "unstackedbar",
                          "chartSettings": {
                            "xAxis": "TaskId",
                            "ySettings": {
                              "numberFormatSettings": {
                                "unit": 2,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": true
                                }
                              }
                            }
                          }
                        },
                        "customWidth": "50",
                        "name": "Bytes Read"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "spark_tab",
                    "comparison": "isEqualTo",
                    "value": "Tasks"
                  },
                  "name": "Tasks"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "tab",
              "comparison": "isEqualTo",
              "value": "Spark"
            },
            "name": "Spark"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "usage",
        "comparison": "isEqualTo",
        "value": "present"
      },
      "name": "Usage"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "No Logs have been detected in your workspace. Please make sure you have enabled Azure Monitor for your cluster.",
              "style": "info"
            },
            "name": "text - 0"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "usage",
        "comparison": "isEqualTo",
        "value": "not present"
      },
      "name": "No Usage"
    }
  ],
  "fallbackResourceIds": [
    "Azure Monitor"
  ],
  "$schema": "https://github.com/Microsoft/Application-Insights-Workbooks/blob/master/schema/workbook.json"
}